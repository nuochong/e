<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一篇文章彻底搞定富文本原理 | 小窝</title>
    <meta name="description" content="博客">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/favicon/favicon.ico">
  <meta name="theme-color" content="#fff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/favicon/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#fff">
  <meta name="msapplication-TileImage" content="/favicon/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1575342_6f51dg8fckd.css" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.0/baguetteBox.css" type="text/css">
  <link rel="stylesheet" href="https://unpkg.com/swiper/css/swiper.css" type="text/css">
  <link rel="stylesheet" href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css" type="text/css">
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v1.7.0/mapbox-gl.css" type="text/css">
  <link rel="stylesheet" href="https://www.zhangxinxu.com/study/201903/css-idea/cssgram.min.css" type="text/css">
  <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.firebase.com/js/client/2.0.4/firebase.js"></script>
  <script src="https://unpkg.com/swiper/js/swiper.js"></script>
  <script src="https://static.runoob.com/assets/qrcode/qrcode.min.js"></script>
  <script src="https://unpkg.com/vue-toasted"></script>
  <script src="https://cdn.bootcss.com/wow/1.1.2/wow.js"></script>
  <script src="https://cdn.bootcss.com/velocity/2.0.5/velocity.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/locale/zh-cn.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v1.7.0/mapbox-gl.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-language/v0.10.1/mapbox-gl-language.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/console-badge"></script>
  <link rel="alternate" type="application/rss+xml" href="https://luzhaoyang.com/rss.xml" title=" RSS Feed">
  <link rel="alternate" type="application/atom+xml" href="https://luzhaoyang.com/feed.atom" title=" Atom Feed">
  <link rel="alternate" type="application/json" href="https://luzhaoyang.com/feed.json" title=" JSON Feed">
    <meta property="article:published_time" content="Sun Aug 25 2019 16:00:00 GMT+0800 (GMT+08:00)"><meta property="article:modified_time" content="Sun Aug 25 2019 16:00:00 GMT+0800 (GMT+08:00)"><meta property="og:title" content="一篇文章彻底搞定富文本原理"><meta property="og:type" content="website"><meta property="og:url" content="https://luzhaoyang.com/zh/posts/yi-pian-wen-zhang-che-di-gao-ding-fu-wen-ben-yuan-li.html"><meta property="og:image" content="https://luzhaoyang.com/image-social-share.png"><meta name="twitter:title" content="一篇文章彻底搞定富文本原理"><meta name="twitter:url" content="https://luzhaoyang.com/zh/posts/yi-pian-wen-zhang-che-di-gao-ding-fu-wen-ben-yuan-li.html"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://luzhaoyang.com/image-social-share.png"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="前端开发"><meta property="article:tag" content="前端开发">
    <link rel="preload" href="/assets/css/styles.311a7293.css" as="style"><link rel="preload" href="/assets/js/app.311a7293.js" as="script"><link rel="preload" href="/assets/css/19.styles.dcacacc1.css" as="style"><link rel="preload" href="/assets/js/19.dcacacc1.js" as="script"><link rel="preload" href="/assets/css/4.styles.69440542.css" as="style"><link rel="preload" href="/assets/js/4.69440542.js" as="script"><link rel="preload" href="/assets/css/18.styles.bec2e118.css" as="style"><link rel="preload" href="/assets/js/18.bec2e118.js" as="script"><link rel="preload" href="/assets/css/17.styles.458228f4.css" as="style"><link rel="preload" href="/assets/js/17.458228f4.js" as="script"><link rel="preload" href="/assets/css/25.styles.5b53f3bd.css" as="style"><link rel="preload" href="/assets/js/25.5b53f3bd.js" as="script"><link rel="preload" href="/assets/css/0.styles.ae7cd7de.css" as="style"><link rel="preload" href="/assets/js/0.ae7cd7de.js" as="script"><link rel="preload" href="/assets/js/5.69013498.js" as="script"><link rel="preload" href="/assets/css/3.styles.db90c815.css" as="style"><link rel="preload" href="/assets/js/3.db90c815.js" as="script"><link rel="preload" href="/assets/css/22.styles.e865591f.css" as="style"><link rel="preload" href="/assets/js/22.e865591f.js" as="script"><link rel="preload" href="/assets/js/77.33c0a8c0.js" as="script"><link rel="preload" href="/assets/css/6.styles.a9883823.css" as="style"><link rel="preload" href="/assets/js/6.a9883823.js" as="script"><link rel="preload" href="/assets/css/14.styles.29ac064c.css" as="style"><link rel="preload" href="/assets/js/14.29ac064c.js" as="script"><link rel="preload" href="/assets/css/1.styles.0dc3c290.css" as="style"><link rel="preload" href="/assets/js/1.0dc3c290.js" as="script"><link rel="preload" href="/assets/css/11.styles.bcbfb94b.css" as="style"><link rel="preload" href="/assets/js/11.bcbfb94b.js" as="script"><link rel="preload" href="/assets/css/20.styles.ef84bf74.css" as="style"><link rel="preload" href="/assets/js/20.ef84bf74.js" as="script"><link rel="preload" href="/assets/css/2.styles.732d2fee.css" as="style"><link rel="preload" href="/assets/js/2.732d2fee.js" as="script"><link rel="preload" href="/assets/css/26.styles.be22555f.css" as="style"><link rel="preload" href="/assets/js/26.be22555f.js" as="script"><link rel="prefetch" href="/assets/css/10.styles.05002d23.css"><link rel="prefetch" href="/assets/css/12.styles.2c1b2e2f.css"><link rel="prefetch" href="/assets/css/13.styles.554f308e.css"><link rel="prefetch" href="/assets/css/15.styles.dd016190.css"><link rel="prefetch" href="/assets/css/16.styles.a0a8e70c.css"><link rel="prefetch" href="/assets/css/21.styles.2db76927.css"><link rel="prefetch" href="/assets/css/23.styles.8b3a5897.css"><link rel="prefetch" href="/assets/css/24.styles.65337443.css"><link rel="prefetch" href="/assets/css/30.styles.a07fdc96.css"><link rel="prefetch" href="/assets/css/7.styles.28a03364.css"><link rel="prefetch" href="/assets/js/10.05002d23.js"><link rel="prefetch" href="/assets/js/100.c2d8b284.js"><link rel="prefetch" href="/assets/js/101.527a2617.js"><link rel="prefetch" href="/assets/js/102.427f81b2.js"><link rel="prefetch" href="/assets/js/103.597df4df.js"><link rel="prefetch" href="/assets/js/12.2c1b2e2f.js"><link rel="prefetch" href="/assets/js/13.554f308e.js"><link rel="prefetch" href="/assets/js/15.dd016190.js"><link rel="prefetch" href="/assets/js/16.a0a8e70c.js"><link rel="prefetch" href="/assets/js/21.2db76927.js"><link rel="prefetch" href="/assets/js/23.8b3a5897.js"><link rel="prefetch" href="/assets/js/24.65337443.js"><link rel="prefetch" href="/assets/js/27.5f0be41c.js"><link rel="prefetch" href="/assets/js/28.6c166da6.js"><link rel="prefetch" href="/assets/js/29.26975570.js"><link rel="prefetch" href="/assets/js/30.a07fdc96.js"><link rel="prefetch" href="/assets/js/31.4bb02ff2.js"><link rel="prefetch" href="/assets/js/32.98be01b8.js"><link rel="prefetch" href="/assets/js/33.523c442b.js"><link rel="prefetch" href="/assets/js/34.113f3422.js"><link rel="prefetch" href="/assets/js/35.7bcdb222.js"><link rel="prefetch" href="/assets/js/36.a9ce21c6.js"><link rel="prefetch" href="/assets/js/37.6eb3df06.js"><link rel="prefetch" href="/assets/js/38.f91bb703.js"><link rel="prefetch" href="/assets/js/39.2e5c0af2.js"><link rel="prefetch" href="/assets/js/40.2cd0f664.js"><link rel="prefetch" href="/assets/js/41.fc0fc87c.js"><link rel="prefetch" href="/assets/js/42.9956d98a.js"><link rel="prefetch" href="/assets/js/43.57e15d51.js"><link rel="prefetch" href="/assets/js/44.8a28df44.js"><link rel="prefetch" href="/assets/js/45.343bc0a7.js"><link rel="prefetch" href="/assets/js/46.83539358.js"><link rel="prefetch" href="/assets/js/47.4f204ad3.js"><link rel="prefetch" href="/assets/js/48.a2306c44.js"><link rel="prefetch" href="/assets/js/49.0d155851.js"><link rel="prefetch" href="/assets/js/50.cf907db3.js"><link rel="prefetch" href="/assets/js/51.f78de137.js"><link rel="prefetch" href="/assets/js/52.82e223e4.js"><link rel="prefetch" href="/assets/js/53.6c3be969.js"><link rel="prefetch" href="/assets/js/54.40a5c93a.js"><link rel="prefetch" href="/assets/js/55.6f24b177.js"><link rel="prefetch" href="/assets/js/56.b9500abc.js"><link rel="prefetch" href="/assets/js/57.0fcc388e.js"><link rel="prefetch" href="/assets/js/58.ad6e7071.js"><link rel="prefetch" href="/assets/js/59.50c245fb.js"><link rel="prefetch" href="/assets/js/60.8ff7d8f8.js"><link rel="prefetch" href="/assets/js/61.aac50486.js"><link rel="prefetch" href="/assets/js/62.716439fd.js"><link rel="prefetch" href="/assets/js/63.595ff843.js"><link rel="prefetch" href="/assets/js/64.fc696384.js"><link rel="prefetch" href="/assets/js/65.740e31d4.js"><link rel="prefetch" href="/assets/js/66.08fdddfd.js"><link rel="prefetch" href="/assets/js/67.6bb64dbb.js"><link rel="prefetch" href="/assets/js/68.46f1d0a2.js"><link rel="prefetch" href="/assets/js/69.47670580.js"><link rel="prefetch" href="/assets/js/7.28a03364.js"><link rel="prefetch" href="/assets/js/70.0c32c947.js"><link rel="prefetch" href="/assets/js/71.f5efa81e.js"><link rel="prefetch" href="/assets/js/72.be2ce72a.js"><link rel="prefetch" href="/assets/js/73.c7dfd967.js"><link rel="prefetch" href="/assets/js/74.0f81c8dd.js"><link rel="prefetch" href="/assets/js/75.cc55f963.js"><link rel="prefetch" href="/assets/js/76.c0d16b06.js"><link rel="prefetch" href="/assets/js/78.88f28176.js"><link rel="prefetch" href="/assets/js/79.166c73cf.js"><link rel="prefetch" href="/assets/js/80.1c6afc59.js"><link rel="prefetch" href="/assets/js/81.b68de123.js"><link rel="prefetch" href="/assets/js/82.1a9b59fa.js"><link rel="prefetch" href="/assets/js/83.3a3fc24d.js"><link rel="prefetch" href="/assets/js/84.39b92634.js"><link rel="prefetch" href="/assets/js/85.b596e26a.js"><link rel="prefetch" href="/assets/js/86.2c738e7c.js"><link rel="prefetch" href="/assets/js/87.a8e5c114.js"><link rel="prefetch" href="/assets/js/88.dc938041.js"><link rel="prefetch" href="/assets/js/89.5e88088d.js"><link rel="prefetch" href="/assets/js/90.d47e0a1a.js"><link rel="prefetch" href="/assets/js/91.e03df9eb.js"><link rel="prefetch" href="/assets/js/92.7c12b9c5.js"><link rel="prefetch" href="/assets/js/93.5bb9b8ef.js"><link rel="prefetch" href="/assets/js/94.f10995a5.js"><link rel="prefetch" href="/assets/js/95.c337ad2a.js"><link rel="prefetch" href="/assets/js/96.997c759b.js"><link rel="prefetch" href="/assets/js/97.a8fe21c3.js"><link rel="prefetch" href="/assets/js/98.cbaa990e.js"><link rel="prefetch" href="/assets/js/99.6055a97d.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.0a1fbae1.js">
    <link rel="stylesheet" href="/assets/css/styles.311a7293.css"><link rel="stylesheet" href="/assets/css/19.styles.dcacacc1.css"><link rel="stylesheet" href="/assets/css/4.styles.69440542.css"><link rel="stylesheet" href="/assets/css/18.styles.bec2e118.css"><link rel="stylesheet" href="/assets/css/17.styles.458228f4.css"><link rel="stylesheet" href="/assets/css/25.styles.5b53f3bd.css"><link rel="stylesheet" href="/assets/css/0.styles.ae7cd7de.css"><link rel="stylesheet" href="/assets/css/3.styles.db90c815.css"><link rel="stylesheet" href="/assets/css/22.styles.e865591f.css"><link rel="stylesheet" href="/assets/css/6.styles.a9883823.css"><link rel="stylesheet" href="/assets/css/14.styles.29ac064c.css"><link rel="stylesheet" href="/assets/css/1.styles.0dc3c290.css"><link rel="stylesheet" href="/assets/css/11.styles.bcbfb94b.css"><link rel="stylesheet" href="/assets/css/20.styles.ef84bf74.css"><link rel="stylesheet" href="/assets/css/2.styles.732d2fee.css"><link rel="stylesheet" href="/assets/css/26.styles.be22555f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div itemscope="itemscope" itemtype="https://schema.org/WebPage" class="layout-main"><meta itemprop="name" content=""> <meta itemprop="alternateName" content=""> <meta itemprop="url" content="https://luzhaoyang.com"> <nav aria-label="Navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement" class="container nav-mobile not-black" style="display:none;"><span itemprop="headline" class="nav-mobile__title not-black">导航</span> <ul class="nav-mobile__list not-black"><li class="nav-mobile__item not-black"><a href="/zh/categories/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text not-black">文章分类</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/gallery/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text not-black">摄影相册</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/comments/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text not-black">我的留言</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/travel/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text not-black">旅行简记</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/about/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text not-black">关于我们</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/contact/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text not-black">联系我们</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/categories/backend.html" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text not-black">后端开发</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/categories/frontend.html" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text not-black">前端开发</span></a></li></ul></nav> <div class="container-fluid wrapper-body__nm"><header itemscope="itemscope" itemtype="https://schema.org/Organization" class="header"><!----> <div class="row header-top"><div class="column xs-33 sm-20"><div class="hamburguer header-top__hamburguer"><div class="hamburguer__wrapper"><span class="hamburguer__line"></span> <span class="hamburguer__line"></span> <span class="hamburguer__line"></span></div></div> <div class="languages header-top__languages"><div class="languages__box"><span class="languages__title meta-text">ZH</span> <span class="languages__icon"></span></div> <ul class="languages__list"><li class="languages__item"><a href="/" class="languages__link router-link-active">
        English
      </a></li><li class="languages__item"><a href="/zh/posts/yi-pian-wen-zhang-che-di-gao-ding-fu-wen-ben-yuan-li.html" class="languages__link router-link-exact-active router-link-active">
        Chinese
      </a></li></ul></div></div> <div class="column xs-33 sm-60"><div class="header__logo"><a href="/zh/" itemprop="url" class="header-top-logo__link router-link-active"><img itemprop="logo" src="/ktquez-play-logo.png" srcset="/ktquez-play-logo.png 1x, /ktquez-play-logo@2x.png 2x" alt="小窝"></a></div> <meta itemprop="name" content=""> <meta itemprop="sameAs" content="https://i.youku.com/i/UNTcyNDQ2ODky?spm=a2hbt.13141534.1_1.1"><meta itemprop="sameAs" content="https://weibo.com/3032335637/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo"><meta itemprop="sameAs" content="https://space.bilibili.com/25739142"></div> <div class="column xs-33 sm-20"><div class="search header-top__search"><!----> <span class="icon search__icon icon-search"></span></div> <div class="switch-bw header-top__toggle"><span class="switch-bw__text">
    开启夜间模式
  </span> <label for="switch-bw" class="switch-bw__label"><input type="checkbox" id="switch-bw" name="switch-bw" aria-labelledby="switch-bw-text" class="switch-bw__input"> <span class="switch-bw__ball"></span> <span id="switch-bw-text" hidden="hidden">switch to black or white</span></label></div></div></div></header> <main id="main" itemscope="itemscope" itemtype="https://schema.org/Blog" class="main-page"><div><a href="#main" class="vue-skip-to">跳到主要内容</a> <div><div class="page page__full row justify-right"><article itemscope="itemscope" itemprop="blogPost" itemtype="https://schema.org/BlogPosting" class="column xs-100 page__full__box box-default"><meta itemprop="mainEntityOfPage" content="/zh/posts/yi-pian-wen-zhang-che-di-gao-ding-fu-wen-ben-yuan-li.html"> <header class="page-header page__full-header"><button type="button" class="ui-button reset-button back-button"><span class="icon back-button__icon icon--arrow icon-arrow"></span> <span class="back-button__text">返回</span></button> <div class="page-header__meta"><time datetime="Sun Aug 25 2019 16:00:00 GMT+0800 (GMT+08:00)" itemprop="datePublished" class="text">
            </time> <meta itemprop="dateModified" content="currentPost.updated_at"> <!----></div> <h1 itemprop="name headline" class="page-header__title">一篇文章彻底搞定富文本原理</h1> <div class="page-header-cat"><nav class="page-header-cat__nav"><ul class="page-header-cat__list"><li class="page-header-cat__item"><a href="/zh/categories/frontend.html" itemprop="keywords" class="page-header-cat__link meta-text">
                  前端开发
                </a></li></ul></nav></div> <div itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person" class="page-header__author"><strong>作者: </strong> <a href="/zh/authors/nuochong.html" rel="author" itemprop="url" class="link link--filler-s-primary"><span itemprop="name" class="not-black">诺冲</span></a></div></header> <!----> <!----> <section class="page-content page__full-content"><div class="row"><div class="column no-pad-l sm-50 post-share"><div class="observer" data-v-e3cf7e50><!----> <!----> <!----></div></div> <!----></div> <div class="row"><div class="column no-pad-l md-75 xl-67 post-content"><div class="post-content__box-player"><!----></div> <div class="post-content__excerpt"><!----></div> <div class="post-content__table-contents"><div class="table-contents"><h3 id="table-of-content" class="table-contents__title">目录</h3> <nav><ol class="table-contents__list"><li class="table-contents__item"><a href="#缘起" title="缘起" class="table-contents__link"><span>缘起</span></a></li><li class="table-contents__item"><a href="#前置知识" title="前置知识" class="table-contents__link"><span>前置知识</span></a></li><li class="table-contents__item"><a href="#contenteditable-属性" title="contenteditable 属性" class="table-contents__link"><span>contenteditable 属性</span></a></li><li class="table-contents__item"><a href="#document-execcommand-方法" title="document.execCommand 方法" class="table-contents__link"><span>document.execCommand 方法</span></a></li><li class="table-contents__item"><a href="#selection-和-range-对象" title="Selection 和 Range 对象" class="table-contents__link"><span>Selection 和 Range 对象</span></a></li><li class="table-contents__item"><a href="#目标" title="目标" class="table-contents__link"><span>目标</span></a></li><li class="table-contents__item"><a href="#起步" title="起步" class="table-contents__link"><span>起步</span></a></li><li class="table-contents__item"><a href="#加粗" title="加粗" class="table-contents__link"><span>加粗</span></a></li><li class="table-contents__item"><a href="#段落" title="段落" class="table-contents__link"><span>段落</span></a></li><li class="table-contents__item"><a href="#插入链接" title="插入链接" class="table-contents__link"><span>插入链接</span></a></li><li class="table-contents__item"><a href="#插入图片" title="插入图片" class="table-contents__link"><span>插入图片</span></a></li><li class="table-contents__item"><a href="#进阶" title="进阶" class="table-contents__link"><span>进阶</span></a></li><li class="table-contents__item"><a href="#图片拉伸" title="图片拉伸" class="table-contents__link"><span>图片拉伸</span></a></li><li class="table-contents__item"><a href="#_2-在点击的图片上创建个大小一样的-div" title="2. 在点击的图片上创建个大小一样的 div" class="table-contents__link"><span>2. 在点击的图片上创建个大小一样的 div</span></a></li><li class="table-contents__item"><a href="#_3-在四个顶点框上添加拖拽事件" title="3. 在四个顶点框上添加拖拽事件" class="table-contents__link"><span>3. 在四个顶点框上添加拖拽事件</span></a></li><li class="table-contents__item"><a href="#操纵光标" title="操纵光标" class="table-contents__link"><span>操纵光标</span></a></li><li class="table-contents__item"><a href="#结语" title="结语" class="table-contents__link"><span>结语</span></a></li></ol></nav></div></div> <div itemprop="articleBody"><div class="content__default"><h2 id="缘起"><a href="#缘起" class="header-anchor">#</a> 缘起</h2> <p>最近产品想让我在富文本里加个旋转图片的功能，我一想 🤔，就觉得事情并不简单，因为印象中好像没见过这种操作。果然，经过一番百度之后，确实没怎么看到相关信息，这也就意味着要自己动手丰衣足食了 😢。但我自己对富文本又没什么了解，所以顺带稍微看了下富文本的实现方式，特此来沉淀一下，还是那句话不喜勿喷哈 🙄。
ok，这里先简要说下为什么会有富文本这种东西吧 🤓！大概可能也许是因为有一天产品用着用着 textarea 感觉太单调了，单纯的文字已经无法表达他们内心的需求 🤯，于是就想来点样式，顺便加个图片，来篇图文并茂的文章，就像小型 Word 那样，就再好不过了！于是富文本就这样诞生了，开发者们也纷纷开始了踩坑之旅 🕳🕳🕳。</p> <h2 id="前置知识"><a href="#前置知识" class="header-anchor">#</a> 前置知识</h2> <p>好了，交代完了背景，让我们先补充一些基础知识吧，不懂的请务必不要跳过 🧐！</p> <h2 id="contenteditable-属性"><a href="#contenteditable-属性" class="header-anchor">#</a> contenteditable 属性</h2> <p>假如我们给一个标签加上<code>contenteditable=&quot;true&quot;</code>的属性，就像这样：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">contenteditable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>那么在这个 div 中我们就可以对其进行任意编辑了。如果想要插入的子节点不可编辑，我们只需要把子节点的属性设置为<code>contenteditable=&quot;false&quot;</code>即可，就像这样：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">contenteditable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
    这是可编辑的
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">contenteditable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    这是不可编辑的
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>该属性最早是在 IE 上实现的（厉害哦 👍），且可以作用于其它标签，不限于 div，大家应该或多或少都听说过这个属性。</p> <h2 id="document-execcommand-方法"><a href="#document-execcommand-方法" class="header-anchor">#</a> document.execCommand 方法</h2> <p>既然我们可以对上面的 div 随意编辑，那具体怎么编辑呢，目前好像也还是只能输入文本，要怎样才能进行其他操作呢（比如加粗、倾斜、插入图片等等）🤔？其实浏览器给我们提供了这样的一个方法<code>document.execCommand</code>，通过它我们就能够操纵上面的可编辑区。具体语法如下：</p> <div class="language- extra-class"><pre class="language-text"><code>// document.execCommand(命令名称，是否展示用户界面，命令需要的额外参数)
document.execCommand(aCommandName, aShowDefaultUI, aValueArgument)
</code></pre></div><p>其中第一个参数就是一些命令名称，具体的可以查看 MDN；第二个参数写死为 false 就行了，因为早前 IE 有这样一个参数，为了兼容吧，不过这个参数在现代浏览器中是没有影响的；第三个参数就是一些命令可能需要额外的参数，比如插入图片就要多传个 url 或 base64 的参数，没有的话传个 null 就行。
我们简要列举下它的几个使用方式，大家就知道怎么用了 👇：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 加粗</span>
document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'bold'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 添加图片</span>
document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'insertImage'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> url <span class="token operator">||</span> base64<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 把一段文字用 p 标签包裹起来</span>
document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'formatblock'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'&lt;p&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这个命令就是富文本的核心（所以务必记住），浏览器把大部分我们能想到的功能也都实现了，当然各浏览器之间还是有差异的，这里就不考虑了。</p> <h2 id="selection-和-range-对象"><a href="#selection-和-range-对象" class="header-anchor">#</a> Selection 和 Range 对象</h2> <p>我们在执行<code>document.execCommand</code>这个命令之前首先要知道对谁执行，所以这里会有一个选区的概念，也就是<code>Selection</code>对象，它用来表示用户选择的范围或光标位置（光标可以看做是范围重合的特殊状态），一个页面用户可能选择多个范围（比如 Firefox）。也就是说<code>Selection</code>包含一个或多个<code>Range</code>对象（<code>Selection</code>可以说是<code>Range</code>的集合），当然对于富文本编辑器来说，一般情况下，我们只会有一个选择区域，也就是一个<code>Range</code>对象，事实上大部分情况也是如此。
所以通常我们可以用<code>letrange=window.getSelection().getRangeAt(0)</code>来获取选中的内容信息（<code>getRangeAt</code>接受一个索引值，因为会有多个<code>Range</code>，而现在只有一个，所以写 0）。
看得一头雾水 😴？没关系，看下面两张图就懂了 😮：</p> <figure><img src="/images/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%BD%BB%E5%BA%95%E6%90%9E%E5%AE%9A%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8E%9F%E7%90%86/640-6.gif" alt="An image"><figcaption>An image</figcaption></figure> <p>一句话说就是：通过上面那句命令我们能够获取到当前的选中信息，一般会先保存下来，然后在需要的时候还原。此外<code>Selection</code>对象还有几个常用的方法，<code>addRange</code>、<code>removeAllRanges</code>、<code>collapse</code>和<code>collapseToEnd</code>等等。
这个知识点是很重要的，因为它让我们有了操纵光标的能力（比如插入内容之后设置光标的位置），不过这篇文章中我并没有去深入它，只是浅出 😏。</p> <h2 id="目标"><a href="#目标" class="header-anchor">#</a> 目标</h2> <p>开篇一顿扯，下面让我们抓紧时间做一个属于自己的富文本吧 💪，大概会包含以下几个功能：加粗、段落、H1、水平线、无序列表、插入链接、插入图片、后退一步、向前一步等等。🆗，Let’s do it!</p> <h2 id="起步"><a href="#起步" class="header-anchor">#</a> 起步</h2> <p>首先一个富文本大体分为两个区域，一个是按钮区，一个是编辑区。所以它的大致结构就像下面这样：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xr-editor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--按钮区--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>nav<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>
        加粗
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      ...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--编辑区--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>editor<span class="token punctuation">&quot;</span></span> <span class="token attr-name">contenteditable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--全部样式就这些，这里就都先给出来了--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.xr-editor</span> <span class="token punctuation">{</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 50px auto<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 1000px<span class="token selector">;
    .nav</span> <span class="token punctuation">{</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token selector">;
      button</span> <span class="token punctuation">{</span>
        <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">&amp;__img</span> <span class="token punctuation">{</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token selector">;
        input</span> <span class="token punctuation">{</span>
          <span class="token property">width</span><span class="token punctuation">:</span> 100 %<span class="token punctuation">;</span>
          <span class="token property">height</span><span class="token punctuation">:</span> 100 %<span class="token punctuation">;</span>
          <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
          <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
          <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
          <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.row</span> <span class="token punctuation">{</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 100 %<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.editor</span> <span class="token punctuation">{</span>
      <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
      <span class="token property">margin-right</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
      <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #000<span class="token punctuation">;</span>
      <span class="token property">overflow-y</span><span class="token punctuation">:</span> scroll<span class="token selector">;
      img</span> <span class="token punctuation">{</span>
        <span class="token property">max-width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
        <span class="token property">max-height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
        <span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.content</span> <span class="token punctuation">{</span>
      <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #000<span class="token punctuation">;</span>
      <span class="token property">word-break</span><span class="token punctuation">:</span> break -all<span class="token punctuation">;</span>
      <span class="token property">word-wrap</span><span class="token punctuation">:</span> break -word<span class="token punctuation">;</span>
      <span class="token property">overflow</span><span class="token punctuation">:</span> scroll<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>嗯，起步工作到此结束，接下来就可以直接开始实现功能了 😬。</p> <h2 id="加粗"><a href="#加粗" class="header-anchor">#</a> 加粗</h2> <p>现在假如我们要实现加粗的效果，该怎么做呢？很简单，只要在点击加粗按钮的时候执行<code>document.execCommand('bold',false,null)</code>这句话，就能达到加粗的效果，就像下面这样：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>nav<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@</span> <span class="token attr-name">click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>execCommand<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      加粗
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'XrEditor'</span><span class="token punctuation">,</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'bold'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>让我们运行一下看看效果：</p> <figure><img src="/images/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%BD%BB%E5%BA%95%E6%90%9E%E5%AE%9A%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8E%9F%E7%90%86/640.gif" alt="An image"><figcaption>An image</figcaption></figure> <p>嗯，是的，就是这么简单的一句话就能搞定 😒。
当然了，我们开篇也说了我们的一切命令都是基于<code>document.execCommand</code>的，所以我们先小小改写一下上面代码中的<code>execCommand</code>方法，就像下面这样：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>nav<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@</span> <span class="token attr-name">click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>execCommand('bold')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      加粗
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'XrEditor'</span><span class="token punctuation">,</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>这样一来代码就更具通用性了。实现列表、水平线、前进、后退功能和加粗是一样样的，只需传入不同的命令名即可，就像下面这样，这里就不一一赘述了：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@</span> <span class="token attr-name">click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>execCommand('insertUnorderedList')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  无序列表
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@</span> <span class="token attr-name">click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>execCommand('insertHorizontalRule')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  水平线
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@</span> <span class="token attr-name">click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>execCommand('undo')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  后退
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@</span> <span class="token attr-name">click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>execCommand('redo')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  前进
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>顺带给大家说几个注意点 ✍️：</p> <ol><li>有的同学可能用的不是<code>button</code>标签，然后执行命令就会无效，是因为点击其他标签大多都会造成先失去焦点（或者不知不觉就突然失去焦点了），再执行点击事件，此时没有选区或光标所以会没有效果，这点要留意一下。</li> <li>我们执行的是原生的<code>document.execCommand</code>方法，浏览器自身会对<code>contenteditable</code>这个可编辑区维护一个<code>undo</code>栈和一个<code>redo</code>栈，所以我们才能执行前进和后退的操作，如果我们改写了原生方法，就会破坏原有的栈结构，这时就需要自己去维护，那就麻烦了。</li> <li><code>style</code>里面如果加上<code>scope</code>的话，里面的样式对编辑区的内容是不生效的，因为编辑区里面是后来才创建的元素，所以要么删了<code>scope</code>，要么用<code>/deep/</code>解决（Vue 是这样）。</li></ol> <h2 id="段落"><a href="#段落" class="header-anchor">#</a> 段落</h2> <p>这个功能就是把光标所在行的文字用 p 标签包裹起来，为了演示方便，我们顺便把编辑区的<code>html</code>结构打印出来，所以让我们稍微改一下代码，就像下面这样：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xr-editor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>nav<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@</span> <span class="token attr-name">click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>execCommand('bold')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        加粗
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>execCommand('formatBlock', '&lt;p&gt;')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        段落
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>editor<span class="token punctuation">&quot;</span></span> <span class="token attr-name">contenteditable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@</span> <span class="token attr-name">input</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>print<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {{ html }}
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'XrEditor'</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">{</span>
        html<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>html <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.editor'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>运行效果如下：</p> <figure><img src="/images/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%BD%BB%E5%BA%95%E6%90%9E%E5%AE%9A%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8E%9F%E7%90%86/640-1.gif" alt="An image"><figcaption>An image</figcaption></figure> <p>怎么样，是不是也很 easy，同理，<code>h1</code>~<code>h6</code>也是一样的，命令为<code>execCommand('formatBlock','&lt;h1&gt;')</code>，也不赘述了。</p> <h2 id="插入链接"><a href="#插入链接" class="header-anchor">#</a> 插入链接</h2> <p>这个功能因为需要第三个参数，所以我们一般会给个提示框获取用户输入，然后再执行<code>execCommand('createLink',链接地址)</code>，代码如下：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>createLink<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  链接
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">createLink</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">'请输入链接地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'createLink'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>效果如下：</p> <figure><img src="/images/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%BD%BB%E5%BA%95%E6%90%9E%E5%AE%9A%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8E%9F%E7%90%86/640-2.gif" alt="An image"><figcaption>An image</figcaption></figure> <p>插入图片链接也是异曲同工，只不过命令名不一样而已：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">insertImgLink</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">'请输入图片地址'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'insertImage'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="插入图片"><a href="#插入图片" class="header-anchor">#</a> 插入图片</h2> <p>图片除了可以通过添加地址的形式外，还可以添加 base64 格式的图片，这里我们通过<code>readAsDataURL(file)</code>来读取图片，并执行<code>execCommand('insertImage',base64)</code>就大功告成啦，具体代码如下，并不复杂：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>nav__img<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  插入图片
  <span class="token comment">&lt;!--这个 input 是隐藏的--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>image/gif, image/jpeg, image/png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@</span> <span class="token attr-name">change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>insertImg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">insertImg</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> file <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> base64Img <span class="token operator">=</span> reader<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'insertImage'</span><span class="token punctuation">,</span> base64Img<span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.nav__img input'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token comment">// 解决同一张图片上传无效的问题</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><figure><img src="/images/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%BD%BB%E5%BA%95%E6%90%9E%E5%AE%9A%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8E%9F%E7%90%86/640-3.gif" alt="An image"><figcaption>An image</figcaption></figure> <p>运行一下，看看效果：</p> <p>这应该也不是很难。当然了，你也可以先上传到服务器处理返回 url 地址再插入也是可以的。
👌 至此，一个简易版的富文本就完成了（当然了 bug 也是有的 🤭，不过并不妨碍我们理解），具体代码可以参考 npm 上的 pell 包，它已经是个极简版的了。</p> <h2 id="进阶"><a href="#进阶" class="header-anchor">#</a> 进阶</h2> <p>其实富文本对文本的操作大多都可以用原生命令来实现，但是对图片的操作也许就不那么容易了，来个拉伸、旋转啥的就够我们折腾了 🤨，所以这里以图片拉伸为例子着重讲解一下。</p> <h2 id="图片拉伸"><a href="#图片拉伸" class="header-anchor">#</a> 图片拉伸</h2> <p>我们先看下大致效果，大家也可以先停下来思考一分钟看看如何实现 🤔：</p> <figure><img src="/images/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%BD%BB%E5%BA%95%E6%90%9E%E5%AE%9A%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8E%9F%E7%90%86/640-4.gif" alt="An image"><figcaption>An image</figcaption></figure> <p>👌，首先我们要知道的是图片已经在编辑区了，所以当用户点击编辑区里面的图片时我们需要做些事件监听并有所处理，具体思路如下（这部分代码较多，不想看的可以略过，但标题要看）：</p> <ol><li>判断用户点击的是否是编辑区里面的图片
这个就是看点击事件<code>e.target.tagName</code>是不是<code>img</code>标签了，代码如下，应该比较简单：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>editor <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.editor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>editor<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
methods<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'IMG'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClickImg</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-在点击的图片上创建个大小一样的-div"><a href="#_2-在点击的图片上创建个大小一样的-div" class="header-anchor">#</a> 2. 在点击的图片上创建个大小一样的 div</h2> <p>如果点击的是一个图片，那我们就创建一个<code>div</code>，暂且把这个<code>div</code>叫做蒙层吧，顺便先看张示意图：</p> <figure><img src="/images/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%BD%BB%E5%BA%95%E6%90%9E%E5%AE%9A%E5%AF%8C%E6%96%87%E6%9C%AC%E5%8E%9F%E7%90%86/640.webp" alt="An image"><figcaption>An image</figcaption></figure> <p>也就是动态创建一个蒙层（和图片一样大小）以及四个拖拽顶点，并定位到和图片一样的位置，代码如下（代码有点多，可跳过，知道大致意思就行 😬）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">handleClickImg</span><span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>nowImg <span class="token operator">=</span> img<span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showOverlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token function">showOverlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 添加蒙层</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>overlay <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>editor<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 定位蒙层和大小</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">repositionOverlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">repositionOverlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> imgRect <span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>nowImg<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> editorRect <span class="token operator">=</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>editor<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置蒙层宽高和位置</span>
  Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span>style<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    position<span class="token operator">:</span><span class="token string">'absolute'</span><span class="token punctuation">,</span>
    top<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>imgRect<span class="token punctuation">.</span>top <span class="token operator">-</span> editorRect<span class="token punctuation">.</span>top <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>editor<span class="token punctuation">.</span>scrollTop<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    left<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>imgRect<span class="token punctuation">.</span>left <span class="token operator">-</span> editorRect<span class="token punctuation">.</span>left <span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>editor<span class="token punctuation">.</span>scrollLeft<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    width<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>imgRect<span class="token punctuation">.</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>imgRect<span class="token punctuation">.</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    boxSizing<span class="token operator">:</span><span class="token string">'border-box'</span><span class="token punctuation">,</span>
    border<span class="token operator">:</span><span class="token string">'1px dashed red'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加四个顶点拖拽框</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">createBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>boxes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addBox</span><span class="token punctuation">(</span><span class="token string">'nwse-resize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// top left</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addBox</span><span class="token punctuation">(</span><span class="token string">'nesw-resize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// top right</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addBox</span><span class="token punctuation">(</span><span class="token string">'nwse-resize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// bottom right</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addBox</span><span class="token punctuation">(</span><span class="token string">'nesw-resize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// bottom left</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">positionBoxes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置四个拖拽框位置</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">addBox</span><span class="token punctuation">(</span><span class="token parameter">cursor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>box<span class="token punctuation">.</span>style<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  position<span class="token operator">:</span><span class="token string">'absolute'</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span><span class="token string">'12px'</span><span class="token punctuation">,</span>
  width<span class="token operator">:</span><span class="token string">'12px'</span><span class="token punctuation">,</span>
  backgroundColor<span class="token operator">:</span><span class="token string">'white'</span><span class="token punctuation">,</span>
  border<span class="token operator">:</span><span class="token string">'1px solid #777'</span><span class="token punctuation">,</span>
  boxSizing<span class="token operator">:</span><span class="token string">'border-box'</span><span class="token punctuation">,</span>
  opacity<span class="token operator">:</span><span class="token string">'0.80'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor <span class="token operator">=</span> cursor<span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousedown'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleMousedown<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 顺便添加事件</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>box<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>boxes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>box<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">positionBoxes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> handleXOffset <span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">-6px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> handleYOffset <span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">-6px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token punctuation">{</span> left<span class="token operator">:</span> handleXOffset<span class="token punctuation">,</span> top<span class="token operator">:</span> handleYOffset <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span> right<span class="token operator">:</span> handleXOffset<span class="token punctuation">,</span> top<span class="token operator">:</span> handleYOffset <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span> right<span class="token operator">:</span> handleXOffset<span class="token punctuation">,</span> bottom<span class="token operator">:</span> handleYOffset <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span> left<span class="token operator">:</span> handleXOffset<span class="token punctuation">,</span> bottom<span class="token operator">:</span> handleYOffset <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>boxes<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="_3-在四个顶点框上添加拖拽事件"><a href="#_3-在四个顶点框上添加拖拽事件" class="header-anchor">#</a> 3. 在四个顶点框上添加拖拽事件</h2> <p>这里我们会在四个顶点监听<code>mousedown</code>事件，按下鼠标时，首先会改变鼠标样式（就是鼠标会变成调整大小的那种图标），然后监听<code>mousemove</code>和<code>mouseup</code>事件，计算出水平拖拽距离，然后重新设置图片大小和浮层大小，大概这么个意思，简要代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">handleMousedown</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dragBox <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dragStartX <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>preDragWidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>nowImg<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setCursor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragBox<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleDrag<span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mouseup'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseup<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">handleDrag</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 计算水平拖动距离</span>
  <span class="token keyword">const</span> deltaX <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX <span class="token operator">-</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragStartX<span class="token punctuation">;</span>
  <span class="token comment">// 修改图片大小</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragBox <span class="token operator">===</span><span class="token keyword">this</span><span class="token punctuation">.</span>boxes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragBox <span class="token operator">===</span><span class="token keyword">this</span><span class="token punctuation">.</span>boxes<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 左边的两个框</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>nowImg<span class="token punctuation">.</span>width <span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>preDragWidth <span class="token operator">-</span> deltaX<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  <span class="token comment">// 右边的两个框</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>nowImg<span class="token punctuation">.</span>width <span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>preDragWidth <span class="token operator">+</span> deltaX<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token comment">// 同时修改蒙层大小</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">repositionOverlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">handleMouseup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setCursor</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 拖拽结束移除事件监听</span>
  document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleDrag<span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mouseup'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseup<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">setCursor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 设置鼠标样式</span>
  <span class="token punctuation">[</span>document<span class="token punctuation">.</span>body<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>nowImg<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">el</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor <span class="token operator">=</span> value<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当然问题还是有的，不过我们知道这个思路就行。具体代码可以去看下 npm 上的 quill-image-resize-module 包，我也是按照这个包的思路来讲解的 😂。。。</p> <h2 id="操纵光标"><a href="#操纵光标" class="header-anchor">#</a> 操纵光标</h2> <p>除了不好对图片进行处理外，光标应该也是一大坑，你可能不知道什么时候就失去焦点了，此时再点击按钮执行命令就无效了；有时你又需要还原或设置光标的位置，比如插入图片后，光标要设置到图片后面等等之类的。
所以我们需要具有控制光标的能力，具体操作就是在点击按钮之前我们可以先存储当前光标的状态，执行完命令或者在需要的时候后再还原或设置光标的状态即可。由于在 chrome 中，失去焦点并不会清除<code>Seleciton</code>对象和<code>Range</code>对象，所以就像我一开始说的我没怎么去了解 🙄。。。这里就只简要展示两个方法给大家看下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">saveSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 保存当前Range对象</span>
  <span class="token keyword">let</span> selection <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>selection<span class="token punctuation">.</span>rangeCount <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
    sel<span class="token punctuation">.</span><span class="token function">getRangeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  returnnull<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> selectedRange <span class="token operator">=</span> <span class="token function">saveSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">restoreSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> selection <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedRange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    selection<span class="token punctuation">.</span><span class="token function">removeAllRanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 清空所有 Range 对象</span>
    selection<span class="token punctuation">.</span><span class="token function">addRange</span><span class="token punctuation">(</span>selectedRange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 恢复保存的 Range</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>以上就是今天所要分享的内容，感谢你的阅读，大赞无疆 👀 。。。。</p> <h2 id="结语"><a href="#结语" class="header-anchor">#</a> 结语</h2> <p>回到开头我们讲的那个需求，关于图片旋转的，根据上面的思路，你可以在蒙层上加个旋转图标，并添加点击事件，然后修改图片和蒙层 transform 属性，当然了位置也要变，可能需要些计算，我也没试过，不知道效果咋样 😂。
另外一种方法就是在插入图片之前先对图片进行处理（比如多一步类似裁剪的功能）再上传，这样就可以不用在编辑区里面处理图片啦，嘿嘿，目前我就想到这两种方案了，实际工作中采用的是第二种方式，因为产品的需求不止于旋转 😭。
最后的最后，不知道大家有没有更好的方法来对图片或内容进行处理，欢迎在下面留言探讨，See you👋。</p> <p><a href="https://mp.weixin.qq.com/s/kmqT6x-59vkHMdPa8vY4tQ" target="_blank" rel="noopener noreferrer">一篇文章彻底搞定富文本原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div></div></div> <div id="shangfang" class="column no-pad-r sm-25 xl-33 xsNone smNone post-sidebar"><div class="ads-container"><!----></div> <!----> <div id="zhongjian"><div class="table-contents-fixed"><h3 id="table-of-content" class="table-contents__title">浮动目录</h3> <nav><ol class="table-contents__list"></ol></nav></div></div></div> <aside id="dibujuli" class="column xs-100"><hr class="divider"> <div><div class="observer" data-v-e3cf7e50><!----> <!----> <!----></div></div> <hr class="divider"> <section class="post-content__disqus"><!----></section></aside></div></section></article></div> <section class="row section-newsletter justify-center newsletter-post-wrap"><div class="column sm-100 md-67 xl-50"><div class="newsletter not-black"><span class="meta-text meta-text--primary not-black">关注我们</span> <h2 class="newsletter__title not-black">在收件箱接收新的内容推送</h2> <form method="post" action="https://luzhaoyang.us4.list-manage.com/subscribe/post?u=1de83ba90307cf0e38650d622&amp;amp;id=04aeba270a" class="newsletter__form not-black"><label for="email_news-1582212361389" class="newsletter__label not-black"><input type="email" name="EMAIL" id="email_news-1582212361389" required="required" placeholder="在这里输入您的电子邮件" autocomplete="off" aria-label="在这里输入您的电子邮件" value="" class="ui-input-field reset-input newsletter__input"></label> <button type="submit" class="ui-button reset-button newsletter__button txt-upper ui-button--primary">
        订阅
      </button></form></div></div></section> <aside class="container main"></aside></div> <!----> <div><div class="elevator"><a class="elevator__link"><span class="icon elevator__icon icon-greaterthan"></span> <!----></a> <!----></div> <div class="mask-container"><div class="mask-wrap"><div class="circle-wrapper"><svg xmlns="http://www.w3.org/200/svg" height="100%" width="100%"><circle cx="66" cy="66" r="55" fill="none" stroke="#FF4437" stroke-width="5" stroke-linecap="round" class="circle-full"></circle> <circle cx="66" cy="66" r="55" fill="none" stroke-width="5" stroke-linecap="round" stroke="#FF4437" stroke-dasharray="0,10000" class="circle-detail"></circle></svg> <img class="mobile-bgm-img coupon-num had-percent"></div> <div></div> <div></div> <div class="mobile-bgm-list"><i class="reco-bgm reco-bgm-last last mobile-bgm-btn"></i> <i class="reco-bgm reco-bgm-pause pause mobile-bgm-btn" style="display:none;"></i> <i class="reco-bgm reco-bgm-play play mobile-bgm-btn" style="display:;"></i> <i class="reco-bgm reco-bgm-next next mobile-bgm-btn"></i></div> <div class="mobile-bgm-close"><i class="iconfont iconLogonClosed mobile-bgm-btn"></i></div></div></div></div> <!----></div></main> <footer id="footer" class="footer "><div class="footer-box1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1366 161" class="footer-box__shape"><path d="M-11.925-4809v-154.746c40.454,19.75,273.683,130.936,420.544,142.612,161.25,12.821,339.978-42.709,521.543-86.3,169.82-40.769,395.43,29.2,423.912,38.429v60Z" transform="translate(11.926 4970)"></path></svg></div> <div class="footer-box2"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1366 246" class="footer-box__shape"><path d="M-1505.5-4725.5v-238.1c8.149-3.133,18.138-5.059,29.672-5.9h30.954c201.21,11.667,696.6,224.535,855.572,236.458,205.129,15.385,287.179-164.1,432.047-175.625a42.381,42.381,0,0,1,16.756,1.857V-4725.5Z" transform="translate(1506 4971)"></path></svg> <ul class="footer-social__list"><li class="footer-social__item"><a href="https://i.youku.com/i/UNTcyNDQ2ODky?spm=a2hbt.13141534.1_1.1" target="_blank" rel="noopener external" title="Follow us on Facebook"><span class="icon footer-social__icon icon-youku"></span></a></li><li class="footer-social__item"><a href="https://weibo.com/3032335637/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo" target="_blank" rel="noopener external" title="Follow us on Facebook"><span class="icon footer-social__icon icon-sina"></span></a></li><li class="footer-social__item"><a href="https://space.bilibili.com/25739142" target="_blank" rel="noopener external" title="Follow us on Facebook"><span class="icon footer-social__icon icon-bilibili"></span></a></li></ul> <div class="footer-newsletter not-black"><div class="newsletter not-black"><span class="meta-text meta-text--primary not-black">关注我们</span> <h2 class="newsletter__title not-black">在收件箱接收新的内容推送</h2> <form method="post" action="https://luzhaoyang.us4.list-manage.com/subscribe/post?u=1de83ba90307cf0e38650d622&amp;amp;id=04aeba270a" class="newsletter__form not-black"><label for="email_news-1582212361392" class="newsletter__label not-black"><input type="email" name="EMAIL" id="email_news-1582212361392" required="required" placeholder="在这里输入您的电子邮件" autocomplete="off" aria-label="在这里输入您的电子邮件" value="" class="ui-input-field reset-input newsletter__input"></label> <button type="submit" class="ui-button reset-button newsletter__button txt-upper ui-button--primary">
        订阅
      </button></form></div></div></div> <section class="footer-box3"><div class="row"><div class="column sm-50 footer-card"><div class="observer" data-v-e3cf7e50><div class="spinner observer__spinner" data-v-e3cf7e50><div class="double-bounce1"></div> <div class="double-bounce2"></div></div> <!----> <!----></div></div> <div class="column sm-50 footer-nav"><div class="row justify-right"><div class="column xs-50 sm-40 md-33 footer-nav__box footer-nav__box--1 not-black"><h2 class="meta-text title not-black">我的小窝</h2> <nav class="footer-nav1"><ul><li class="footer-nav1__item"><a href="/zh/categories/" class="not-black">文章分类</a> <!----></li><li class="footer-nav1__item"><a href="/zh/gallery/" class="not-black">摄影相册</a> <!----></li><!----><li class="footer-nav1__item"><a href="/zh/travel/" class="not-black">旅行简记</a> <!----></li><li class="footer-nav1__item"><a href="/zh/about/" class="not-black">关于我们</a> <!----></li><li class="footer-nav1__item"><a href="/zh/contact/" class="not-black">联系我们</a> <!----></li></ul></nav></div> <div class="column xs-50 sm-40 md-33 footer-nav__box footer-nav__box--2"><h2 class="meta-text title not-black">社区</h2> <nav class="footer-nav2"><ul><li class="footer-nav2__item"><!----> <a href="https://jq.qq.com/?_wv=1027&amp;k=5sOoWzp" rel="noopener nofollow" target="_blank" class="not-black">Q群 931024509</a></li><li class="footer-nav2__item"><!----> <a href="https://nativescript-vue-examples.luzhaoyang.com/" rel="noopener nofollow" target="_blank" class="not-black">NSVue 示例</a></li><li class="footer-nav2__item"><!----> <a href="https://marketplace.visualstudio.com/items?itemName=nuochong.nativescript-vue-extend" rel="noopener nofollow" target="_blank" class="not-black">NSVue 扩展</a></li></ul></nav></div></div></div> <div class="cpolumn sm-100 footer-copy"><p class="visitors-total" data-v-504ab208><span data-v-504ab208>累计访问</span> <span data-v-504ab208></span> <span data-v-504ab208>次</span></p> <p class="footer-copy-last">2018 - 2020 © NUOCHONG - 源于 
  <a href="https://github.com/" rel="noopener" target="_blank">
    GITHUB
  </a></p></div></div> <span class="shapes shapes--circle" style="left: 3%; top: -20%"></span> <span class="shapes shapes--primary shapes--color3" style="left: 30%; top: -15%"></span> <span class="shapes shapes--primary" style="left: 13%; top: -80%; transform: rotate(45deg)"></span> <span class="shapes shapes--circle shapes--color4" style="left: 40%; top: 200px"></span> <span class="shapes shapes--primary" style="left: 15%; bottom: 10%; transform: rotate(75deg)"></span> <span class="shapes shapes--circle shapes--color3" style="right: 50%; top: 30%"></span> <span class="shapes shapes--primary" style="right: 20%; top: -100%"></span> <span class="shapes shapes--circle" style="right: 10%; top: -20%"></span> <span class="shapes shapes--color4" style="right: 35%; top: -20%; transform: rotate(45deg)"></span> <span class="shapes shapes--circle" style="left: 40%; top: -50%"></span> <span class="shapes shapes--color3" style="right: 30%; top: 20%"></span> <span class="shapes shapes--circle shapes--primary" style="right: 30%; bottom: 20%"></span></section></footer></div> <!----> <!----></div><div class="global-ui"><div><!----> <!----></div><!----></div></div>
    <script src="/assets/js/app.311a7293.js" defer></script><script src="/assets/js/19.dcacacc1.js" defer></script><script src="/assets/js/4.69440542.js" defer></script><script src="/assets/js/18.bec2e118.js" defer></script><script src="/assets/js/17.458228f4.js" defer></script><script src="/assets/js/25.5b53f3bd.js" defer></script><script src="/assets/js/0.ae7cd7de.js" defer></script><script src="/assets/js/5.69013498.js" defer></script><script src="/assets/js/3.db90c815.js" defer></script><script src="/assets/js/22.e865591f.js" defer></script><script src="/assets/js/77.33c0a8c0.js" defer></script><script src="/assets/js/6.a9883823.js" defer></script><script src="/assets/js/14.29ac064c.js" defer></script><script src="/assets/js/1.0dc3c290.js" defer></script><script src="/assets/js/11.bcbfb94b.js" defer></script><script src="/assets/js/20.ef84bf74.js" defer></script><script src="/assets/js/2.732d2fee.js" defer></script><script src="/assets/js/26.be22555f.js" defer></script>
  </body>
</html>
