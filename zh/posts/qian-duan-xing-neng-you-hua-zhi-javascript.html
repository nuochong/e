<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端性能优化之JavaScript | 小窝</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon/favicon.ico">
    <link rel="apple-touch-icon" href="/favicon/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#fff">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_1575342_kyqje1qgas8.css" type="text/css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/baguettebox.js@1.11.0/dist/baguetteBox.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@4.5.1/dist/css/swiper.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mapbox-gl@1.7.0/dist/mapbox-gl.css" type="text/css">
    <link rel="stylesheet" href="https://www.zhangxinxu.com/study/201903/css-idea/cssgram.min.css" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@4.5.1/dist/js/swiper.min.js"></script>
    <script src="https://static.runoob.com/assets/qrcode/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/shakee93/vue-toasted@v1.1.27/dist/vue-toasted.min.js"></script>
    <script src="https://cdn.bootcss.com/wow/1.1.2/wow.min.js"></script>
    <script src="https://cdn.bootcss.com/velocity/2.0.5/velocity.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.24.0/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.24.0/locale/zh-cn.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mapbox-gl@1.7.0/dist/mapbox-gl.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mapbox/mapbox-gl-language@0.10.1/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/console-badge@1.3.0/dist/console-badge.umd.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/leancloud-storage@4.6.1/dist/av-min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exifreader@3.12.2/dist/exif-reader.min.js"></script>
    <link rel="alternate" type="application/rss+xml" href="https://luzhaoyang.com/rss.xml" title=" RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://luzhaoyang.com/feed.atom" title=" Atom Feed">
    <link rel="alternate" type="application/json" href="https://luzhaoyang.com/feed.json" title=" JSON Feed">
    <meta name="description" content="博客">
    <meta property="article:published_time" content="2019-05-26T14:00:00.000Z">
    <meta property="article:modified_time" content="2019-05-26T14:00:00.000Z">
    <meta property="og:title" content="前端性能优化之JavaScript">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://luzhaoyang.com/zh/posts/qian-duan-xing-neng-you-hua-zhi-javascript.html">
    <meta property="og:image" content="https://luzhaoyang.com/social/image-social-share-zh.png">
    <meta name="twitter:title" content="前端性能优化之JavaScript">
    <meta name="twitter:url" content="https://luzhaoyang.com/zh/posts/qian-duan-xing-neng-you-hua-zhi-javascript.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://luzhaoyang.com/social/image-social-share-zh.png">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="前端开发">
    <meta property="article:tag" content="前端开发">
    <meta name="theme-color" content="#fff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/favicon/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="preload" href="/assets/css/styles.79dcca4c.css" as="style"><link rel="preload" href="/assets/js/app.79dcca4c.js" as="script"><link rel="preload" href="/assets/css/33.styles.8d9700f2.css" as="style"><link rel="preload" href="/assets/js/33.8d9700f2.js" as="script"><link rel="preload" href="/assets/css/4.styles.a79b566e.css" as="style"><link rel="preload" href="/assets/js/4.a79b566e.js" as="script"><link rel="preload" href="/assets/css/32.styles.6eba47d8.css" as="style"><link rel="preload" href="/assets/js/32.6eba47d8.js" as="script"><link rel="preload" href="/assets/css/30.styles.babca846.css" as="style"><link rel="preload" href="/assets/js/30.babca846.js" as="script"><link rel="preload" href="/assets/css/35.styles.d6a9423e.css" as="style"><link rel="preload" href="/assets/js/35.d6a9423e.js" as="script"><link rel="preload" href="/assets/css/0.styles.8d478666.css" as="style"><link rel="preload" href="/assets/js/0.8d478666.js" as="script"><link rel="preload" href="/assets/js/3.b2f5dd85.js" as="script"><link rel="preload" href="/assets/css/2.styles.751b6683.css" as="style"><link rel="preload" href="/assets/js/2.751b6683.js" as="script"><link rel="preload" href="/assets/css/8.styles.88814606.css" as="style"><link rel="preload" href="/assets/js/8.88814606.js" as="script"><link rel="preload" href="/assets/js/224.41b0e766.js" as="script"><link rel="preload" href="/assets/css/5.styles.d1231227.css" as="style"><link rel="preload" href="/assets/js/5.d1231227.js" as="script"><link rel="preload" href="/assets/css/6.styles.b56e5265.css" as="style"><link rel="preload" href="/assets/js/6.b56e5265.js" as="script"><link rel="preload" href="/assets/css/1.styles.119b4490.css" as="style"><link rel="preload" href="/assets/js/1.119b4490.js" as="script"><link rel="preload" href="/assets/css/14.styles.1b67e6d6.css" as="style"><link rel="preload" href="/assets/js/14.1b67e6d6.js" as="script"><link rel="preload" href="/assets/css/34.styles.36ec36b6.css" as="style"><link rel="preload" href="/assets/js/34.36ec36b6.js" as="script"><link rel="preload" href="/assets/css/31.styles.03d9eabb.css" as="style"><link rel="preload" href="/assets/js/31.03d9eabb.js" as="script"><link rel="preload" href="/assets/css/37.styles.b37d633e.css" as="style"><link rel="preload" href="/assets/js/37.b37d633e.js" as="script"><link rel="prefetch" href="/assets/css/12.styles.503586f4.css"><link rel="prefetch" href="/assets/css/13.styles.797d490a.css"><link rel="prefetch" href="/assets/css/15.styles.2bfb5195.css"><link rel="prefetch" href="/assets/css/16.styles.9497e44f.css"><link rel="prefetch" href="/assets/css/17.styles.5363b0fa.css"><link rel="prefetch" href="/assets/css/20.styles.2c27e0c5.css"><link rel="prefetch" href="/assets/css/21.styles.7a88e039.css"><link rel="prefetch" href="/assets/css/22.styles.744dc889.css"><link rel="prefetch" href="/assets/css/23.styles.10c56b47.css"><link rel="prefetch" href="/assets/css/24.styles.cc3a29f9.css"><link rel="prefetch" href="/assets/css/25.styles.40b2c61c.css"><link rel="prefetch" href="/assets/css/26.styles.8cdfa447.css"><link rel="prefetch" href="/assets/css/27.styles.ad1344f3.css"><link rel="prefetch" href="/assets/css/28.styles.6233ddb0.css"><link rel="prefetch" href="/assets/css/29.styles.1a96e1aa.css"><link rel="prefetch" href="/assets/css/36.styles.af3973a1.css"><link rel="prefetch" href="/assets/css/7.styles.c53b0c87.css"><link rel="prefetch" href="/assets/js/100.0600bca9.js"><link rel="prefetch" href="/assets/js/101.573b6172.js"><link rel="prefetch" href="/assets/js/102.13a9a043.js"><link rel="prefetch" href="/assets/js/103.c4ed70db.js"><link rel="prefetch" href="/assets/js/104.06886c4f.js"><link rel="prefetch" href="/assets/js/105.9a0b26f0.js"><link rel="prefetch" href="/assets/js/106.38758168.js"><link rel="prefetch" href="/assets/js/107.06cfd5dd.js"><link rel="prefetch" href="/assets/js/108.74e0118c.js"><link rel="prefetch" href="/assets/js/109.db9f8d22.js"><link rel="prefetch" href="/assets/js/110.6eb195a5.js"><link rel="prefetch" href="/assets/js/111.8a420f7a.js"><link rel="prefetch" href="/assets/js/112.48dc46d4.js"><link rel="prefetch" href="/assets/js/113.69c75f16.js"><link rel="prefetch" href="/assets/js/114.51dc93bb.js"><link rel="prefetch" href="/assets/js/115.1f4ca538.js"><link rel="prefetch" href="/assets/js/116.d7e0022f.js"><link rel="prefetch" href="/assets/js/117.b641103d.js"><link rel="prefetch" href="/assets/js/118.d1e68838.js"><link rel="prefetch" href="/assets/js/119.ec71f1a7.js"><link rel="prefetch" href="/assets/js/12.503586f4.js"><link rel="prefetch" href="/assets/js/120.504292c8.js"><link rel="prefetch" href="/assets/js/121.e9f4a04c.js"><link rel="prefetch" href="/assets/js/122.03655886.js"><link rel="prefetch" href="/assets/js/123.acf73beb.js"><link rel="prefetch" href="/assets/js/124.2ee75ce9.js"><link rel="prefetch" href="/assets/js/125.b2e2faf6.js"><link rel="prefetch" href="/assets/js/126.ff9c4e51.js"><link rel="prefetch" href="/assets/js/127.e29caf44.js"><link rel="prefetch" href="/assets/js/128.50f411b5.js"><link rel="prefetch" href="/assets/js/129.a55cd19a.js"><link rel="prefetch" href="/assets/js/13.797d490a.js"><link rel="prefetch" href="/assets/js/130.f8ee33d5.js"><link rel="prefetch" href="/assets/js/131.b3dedd05.js"><link rel="prefetch" href="/assets/js/132.2b567115.js"><link rel="prefetch" href="/assets/js/133.a2b6c8e0.js"><link rel="prefetch" href="/assets/js/134.ea1b8b41.js"><link rel="prefetch" href="/assets/js/135.e7150ee1.js"><link rel="prefetch" href="/assets/js/136.74f411a4.js"><link rel="prefetch" href="/assets/js/137.f7240dd3.js"><link rel="prefetch" href="/assets/js/138.80574746.js"><link rel="prefetch" href="/assets/js/139.75901a61.js"><link rel="prefetch" href="/assets/js/140.8391ce19.js"><link rel="prefetch" href="/assets/js/141.8004ce47.js"><link rel="prefetch" href="/assets/js/142.dd3254af.js"><link rel="prefetch" href="/assets/js/143.33bce7f8.js"><link rel="prefetch" href="/assets/js/144.fa073d55.js"><link rel="prefetch" href="/assets/js/145.9e988f02.js"><link rel="prefetch" href="/assets/js/146.63e69c76.js"><link rel="prefetch" href="/assets/js/147.a68bf82b.js"><link rel="prefetch" href="/assets/js/148.24d71a51.js"><link rel="prefetch" href="/assets/js/149.03a8f623.js"><link rel="prefetch" href="/assets/js/15.2bfb5195.js"><link rel="prefetch" href="/assets/js/150.751a754d.js"><link rel="prefetch" href="/assets/js/151.b03d448b.js"><link rel="prefetch" href="/assets/js/152.49f98861.js"><link rel="prefetch" href="/assets/js/153.1a8c75db.js"><link rel="prefetch" href="/assets/js/154.45560550.js"><link rel="prefetch" href="/assets/js/155.e3605fd1.js"><link rel="prefetch" href="/assets/js/156.07ca0faa.js"><link rel="prefetch" href="/assets/js/157.419f7cc5.js"><link rel="prefetch" href="/assets/js/158.e7cc6c9c.js"><link rel="prefetch" href="/assets/js/159.b4e7dce7.js"><link rel="prefetch" href="/assets/js/16.9497e44f.js"><link rel="prefetch" href="/assets/js/160.1d85fb4b.js"><link rel="prefetch" href="/assets/js/161.01bbcc49.js"><link rel="prefetch" href="/assets/js/162.c7216f5a.js"><link rel="prefetch" href="/assets/js/163.99f8a014.js"><link rel="prefetch" href="/assets/js/164.173423bc.js"><link rel="prefetch" href="/assets/js/165.b56c2290.js"><link rel="prefetch" href="/assets/js/166.139cc5e2.js"><link rel="prefetch" href="/assets/js/167.2c7a6b5e.js"><link rel="prefetch" href="/assets/js/168.fe6867c3.js"><link rel="prefetch" href="/assets/js/169.6da05233.js"><link rel="prefetch" href="/assets/js/17.5363b0fa.js"><link rel="prefetch" href="/assets/js/170.614baf91.js"><link rel="prefetch" href="/assets/js/171.f886de00.js"><link rel="prefetch" href="/assets/js/172.6ee51352.js"><link rel="prefetch" href="/assets/js/173.c32be6a0.js"><link rel="prefetch" href="/assets/js/174.23d15e69.js"><link rel="prefetch" href="/assets/js/175.92321e06.js"><link rel="prefetch" href="/assets/js/176.382a3dde.js"><link rel="prefetch" href="/assets/js/177.d0259891.js"><link rel="prefetch" href="/assets/js/178.12513b12.js"><link rel="prefetch" href="/assets/js/179.b02eae45.js"><link rel="prefetch" href="/assets/js/18.419aec22.js"><link rel="prefetch" href="/assets/js/180.cf9bcad6.js"><link rel="prefetch" href="/assets/js/181.dfb56c5c.js"><link rel="prefetch" href="/assets/js/182.45ccb2d5.js"><link rel="prefetch" href="/assets/js/183.97ca728e.js"><link rel="prefetch" href="/assets/js/184.2fab9980.js"><link rel="prefetch" href="/assets/js/185.ede21cd9.js"><link rel="prefetch" href="/assets/js/186.998da568.js"><link rel="prefetch" href="/assets/js/187.a26b5811.js"><link rel="prefetch" href="/assets/js/188.73091f0a.js"><link rel="prefetch" href="/assets/js/189.38a4dbd5.js"><link rel="prefetch" href="/assets/js/19.71a38aa7.js"><link rel="prefetch" href="/assets/js/190.d3c7d294.js"><link rel="prefetch" href="/assets/js/191.ffbd5ef1.js"><link rel="prefetch" href="/assets/js/192.5a2300f9.js"><link rel="prefetch" href="/assets/js/193.9825abcb.js"><link rel="prefetch" href="/assets/js/194.ef0ed3c6.js"><link rel="prefetch" href="/assets/js/195.5b78ce9e.js"><link rel="prefetch" href="/assets/js/196.7e7e9810.js"><link rel="prefetch" href="/assets/js/197.f1f37ec8.js"><link rel="prefetch" href="/assets/js/198.deb9e9c3.js"><link rel="prefetch" href="/assets/js/199.2a6e3c06.js"><link rel="prefetch" href="/assets/js/20.2c27e0c5.js"><link rel="prefetch" href="/assets/js/200.5d814ae4.js"><link rel="prefetch" href="/assets/js/201.1282b52b.js"><link rel="prefetch" href="/assets/js/202.234cb0e2.js"><link rel="prefetch" href="/assets/js/203.adba1f29.js"><link rel="prefetch" href="/assets/js/204.88677ff9.js"><link rel="prefetch" href="/assets/js/205.81f9a151.js"><link rel="prefetch" href="/assets/js/206.f109c8b0.js"><link rel="prefetch" href="/assets/js/207.9d7f733a.js"><link rel="prefetch" href="/assets/js/208.aa2a408b.js"><link rel="prefetch" href="/assets/js/209.94de5bfe.js"><link rel="prefetch" href="/assets/js/21.7a88e039.js"><link rel="prefetch" href="/assets/js/210.264a7180.js"><link rel="prefetch" href="/assets/js/211.a62da3c3.js"><link rel="prefetch" href="/assets/js/212.ba34fe20.js"><link rel="prefetch" href="/assets/js/213.85e1c0bb.js"><link rel="prefetch" href="/assets/js/214.8b345afd.js"><link rel="prefetch" href="/assets/js/215.4bf38cf3.js"><link rel="prefetch" href="/assets/js/216.938cd524.js"><link rel="prefetch" href="/assets/js/217.9bbbae2c.js"><link rel="prefetch" href="/assets/js/218.c3b139aa.js"><link rel="prefetch" href="/assets/js/219.a5117f57.js"><link rel="prefetch" href="/assets/js/22.744dc889.js"><link rel="prefetch" href="/assets/js/220.e1cbb375.js"><link rel="prefetch" href="/assets/js/221.b2e7cac5.js"><link rel="prefetch" href="/assets/js/222.653b0c1b.js"><link rel="prefetch" href="/assets/js/223.ab9dbdf7.js"><link rel="prefetch" href="/assets/js/225.45063fae.js"><link rel="prefetch" href="/assets/js/226.13408297.js"><link rel="prefetch" href="/assets/js/227.42e2e3a1.js"><link rel="prefetch" href="/assets/js/228.5a84f20c.js"><link rel="prefetch" href="/assets/js/229.19192e50.js"><link rel="prefetch" href="/assets/js/23.10c56b47.js"><link rel="prefetch" href="/assets/js/230.e2276b73.js"><link rel="prefetch" href="/assets/js/231.4438f4b6.js"><link rel="prefetch" href="/assets/js/232.58d3382d.js"><link rel="prefetch" href="/assets/js/233.eac72241.js"><link rel="prefetch" href="/assets/js/234.e22f7e28.js"><link rel="prefetch" href="/assets/js/235.17aac27b.js"><link rel="prefetch" href="/assets/js/236.dd2ef753.js"><link rel="prefetch" href="/assets/js/237.47395b2d.js"><link rel="prefetch" href="/assets/js/238.49eb7e82.js"><link rel="prefetch" href="/assets/js/239.49143a90.js"><link rel="prefetch" href="/assets/js/24.cc3a29f9.js"><link rel="prefetch" href="/assets/js/240.a670d39e.js"><link rel="prefetch" href="/assets/js/241.79b72ec2.js"><link rel="prefetch" href="/assets/js/242.b8a30a08.js"><link rel="prefetch" href="/assets/js/243.674468e9.js"><link rel="prefetch" href="/assets/js/244.580c6617.js"><link rel="prefetch" href="/assets/js/245.477f99e1.js"><link rel="prefetch" href="/assets/js/246.450c9558.js"><link rel="prefetch" href="/assets/js/247.de401613.js"><link rel="prefetch" href="/assets/js/248.2858879e.js"><link rel="prefetch" href="/assets/js/249.358ae8a9.js"><link rel="prefetch" href="/assets/js/25.40b2c61c.js"><link rel="prefetch" href="/assets/js/250.ce9720b9.js"><link rel="prefetch" href="/assets/js/251.44a1b742.js"><link rel="prefetch" href="/assets/js/252.5f7a8527.js"><link rel="prefetch" href="/assets/js/253.5d7a9afc.js"><link rel="prefetch" href="/assets/js/254.63faabdb.js"><link rel="prefetch" href="/assets/js/255.2640f847.js"><link rel="prefetch" href="/assets/js/256.461e3345.js"><link rel="prefetch" href="/assets/js/257.06bc0526.js"><link rel="prefetch" href="/assets/js/258.7eed5c36.js"><link rel="prefetch" href="/assets/js/259.45cb3daa.js"><link rel="prefetch" href="/assets/js/26.8cdfa447.js"><link rel="prefetch" href="/assets/js/260.b92dbaa7.js"><link rel="prefetch" href="/assets/js/261.97b1027e.js"><link rel="prefetch" href="/assets/js/262.efd18ead.js"><link rel="prefetch" href="/assets/js/263.832ad3cd.js"><link rel="prefetch" href="/assets/js/264.4f489e95.js"><link rel="prefetch" href="/assets/js/265.5fc76fba.js"><link rel="prefetch" href="/assets/js/266.f71c84e4.js"><link rel="prefetch" href="/assets/js/267.e972f5ab.js"><link rel="prefetch" href="/assets/js/268.ca5fefc9.js"><link rel="prefetch" href="/assets/js/269.2d58f2f7.js"><link rel="prefetch" href="/assets/js/27.ad1344f3.js"><link rel="prefetch" href="/assets/js/270.94b28c77.js"><link rel="prefetch" href="/assets/js/271.1bbb918f.js"><link rel="prefetch" href="/assets/js/272.613651e2.js"><link rel="prefetch" href="/assets/js/273.3a65e986.js"><link rel="prefetch" href="/assets/js/274.19cd46fa.js"><link rel="prefetch" href="/assets/js/275.0101c0dc.js"><link rel="prefetch" href="/assets/js/276.9e1e6ce2.js"><link rel="prefetch" href="/assets/js/277.ec489108.js"><link rel="prefetch" href="/assets/js/278.5b1b2fd0.js"><link rel="prefetch" href="/assets/js/279.40daf5d5.js"><link rel="prefetch" href="/assets/js/28.6233ddb0.js"><link rel="prefetch" href="/assets/js/280.fb435d3d.js"><link rel="prefetch" href="/assets/js/281.0b1315b3.js"><link rel="prefetch" href="/assets/js/282.d1c15f43.js"><link rel="prefetch" href="/assets/js/283.95311189.js"><link rel="prefetch" href="/assets/js/284.8f6ec903.js"><link rel="prefetch" href="/assets/js/285.4ed7720b.js"><link rel="prefetch" href="/assets/js/286.b4610365.js"><link rel="prefetch" href="/assets/js/287.336bf4ee.js"><link rel="prefetch" href="/assets/js/288.1e414c84.js"><link rel="prefetch" href="/assets/js/289.e86ff03b.js"><link rel="prefetch" href="/assets/js/29.1a96e1aa.js"><link rel="prefetch" href="/assets/js/290.c9faba7f.js"><link rel="prefetch" href="/assets/js/291.0dba4f76.js"><link rel="prefetch" href="/assets/js/292.18c0d231.js"><link rel="prefetch" href="/assets/js/293.50f95157.js"><link rel="prefetch" href="/assets/js/294.7eaf4fbd.js"><link rel="prefetch" href="/assets/js/295.04787d96.js"><link rel="prefetch" href="/assets/js/296.90382417.js"><link rel="prefetch" href="/assets/js/297.fb90f45d.js"><link rel="prefetch" href="/assets/js/298.f258e3ab.js"><link rel="prefetch" href="/assets/js/36.af3973a1.js"><link rel="prefetch" href="/assets/js/38.a605e39f.js"><link rel="prefetch" href="/assets/js/39.20f02e18.js"><link rel="prefetch" href="/assets/js/40.3af7bbe5.js"><link rel="prefetch" href="/assets/js/41.2a0ad7c7.js"><link rel="prefetch" href="/assets/js/42.6a938c33.js"><link rel="prefetch" href="/assets/js/43.d7a24ed6.js"><link rel="prefetch" href="/assets/js/44.d91b5dd1.js"><link rel="prefetch" href="/assets/js/45.fbf755de.js"><link rel="prefetch" href="/assets/js/46.564975ce.js"><link rel="prefetch" href="/assets/js/47.34ca77c4.js"><link rel="prefetch" href="/assets/js/48.b777f05b.js"><link rel="prefetch" href="/assets/js/49.4dd0cfc9.js"><link rel="prefetch" href="/assets/js/50.35f5642b.js"><link rel="prefetch" href="/assets/js/51.8c7348de.js"><link rel="prefetch" href="/assets/js/52.84f68737.js"><link rel="prefetch" href="/assets/js/53.fca24412.js"><link rel="prefetch" href="/assets/js/54.37a244e3.js"><link rel="prefetch" href="/assets/js/55.cfc74240.js"><link rel="prefetch" href="/assets/js/56.70555bf2.js"><link rel="prefetch" href="/assets/js/57.64bf9436.js"><link rel="prefetch" href="/assets/js/58.be4b791a.js"><link rel="prefetch" href="/assets/js/59.b611b267.js"><link rel="prefetch" href="/assets/js/60.d278a879.js"><link rel="prefetch" href="/assets/js/61.68c706a4.js"><link rel="prefetch" href="/assets/js/62.488a982c.js"><link rel="prefetch" href="/assets/js/63.ae8e2309.js"><link rel="prefetch" href="/assets/js/64.e5959777.js"><link rel="prefetch" href="/assets/js/65.79a26517.js"><link rel="prefetch" href="/assets/js/66.6d014c59.js"><link rel="prefetch" href="/assets/js/67.380bf0e9.js"><link rel="prefetch" href="/assets/js/68.a48c09ae.js"><link rel="prefetch" href="/assets/js/69.bec52fed.js"><link rel="prefetch" href="/assets/js/7.c53b0c87.js"><link rel="prefetch" href="/assets/js/70.00712633.js"><link rel="prefetch" href="/assets/js/71.1cc6ac75.js"><link rel="prefetch" href="/assets/js/72.d7e95f69.js"><link rel="prefetch" href="/assets/js/73.4371c485.js"><link rel="prefetch" href="/assets/js/74.d74f63e4.js"><link rel="prefetch" href="/assets/js/75.ba393d6d.js"><link rel="prefetch" href="/assets/js/76.1a25b4ea.js"><link rel="prefetch" href="/assets/js/77.9435f1f1.js"><link rel="prefetch" href="/assets/js/78.836b1098.js"><link rel="prefetch" href="/assets/js/79.c463fba8.js"><link rel="prefetch" href="/assets/js/80.e0dd03cb.js"><link rel="prefetch" href="/assets/js/81.7f61254b.js"><link rel="prefetch" href="/assets/js/82.6c284065.js"><link rel="prefetch" href="/assets/js/83.e45eecdf.js"><link rel="prefetch" href="/assets/js/84.1ddef371.js"><link rel="prefetch" href="/assets/js/85.2edc5aaa.js"><link rel="prefetch" href="/assets/js/86.618321e3.js"><link rel="prefetch" href="/assets/js/87.cd858c58.js"><link rel="prefetch" href="/assets/js/88.8eab3a23.js"><link rel="prefetch" href="/assets/js/89.a1f556d8.js"><link rel="prefetch" href="/assets/js/9.a3f02f09.js"><link rel="prefetch" href="/assets/js/90.08b5f750.js"><link rel="prefetch" href="/assets/js/91.e37098b1.js"><link rel="prefetch" href="/assets/js/92.16dfc568.js"><link rel="prefetch" href="/assets/js/93.a1651f13.js"><link rel="prefetch" href="/assets/js/94.041b0c77.js"><link rel="prefetch" href="/assets/js/95.3322c664.js"><link rel="prefetch" href="/assets/js/96.93deb43e.js"><link rel="prefetch" href="/assets/js/97.d8c9d44b.js"><link rel="prefetch" href="/assets/js/98.54aa2796.js"><link rel="prefetch" href="/assets/js/99.b90f16df.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.e42affc4.js">
    <link rel="stylesheet" href="/assets/css/styles.79dcca4c.css"><link rel="stylesheet" href="/assets/css/33.styles.8d9700f2.css"><link rel="stylesheet" href="/assets/css/4.styles.a79b566e.css"><link rel="stylesheet" href="/assets/css/32.styles.6eba47d8.css"><link rel="stylesheet" href="/assets/css/30.styles.babca846.css"><link rel="stylesheet" href="/assets/css/35.styles.d6a9423e.css"><link rel="stylesheet" href="/assets/css/0.styles.8d478666.css"><link rel="stylesheet" href="/assets/css/2.styles.751b6683.css"><link rel="stylesheet" href="/assets/css/8.styles.88814606.css"><link rel="stylesheet" href="/assets/css/5.styles.d1231227.css"><link rel="stylesheet" href="/assets/css/6.styles.b56e5265.css"><link rel="stylesheet" href="/assets/css/1.styles.119b4490.css"><link rel="stylesheet" href="/assets/css/14.styles.1b67e6d6.css"><link rel="stylesheet" href="/assets/css/34.styles.36ec36b6.css"><link rel="stylesheet" href="/assets/css/31.styles.03d9eabb.css"><link rel="stylesheet" href="/assets/css/37.styles.b37d633e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div itemscope="itemscope" itemtype="https://schema.org/WebPage" class="layout-main"><meta itemprop="name" content=""> <meta itemprop="alternateName" content=""> <meta itemprop="url" content="https://luzhaoyang.com"> <nav aria-label="Navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement" class="container nav-mobile not-black" style="display:none;"><span itemprop="headline" class="nav-mobile__title not-black">导航</span> <ul class="nav-mobile__list not-black"><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">文章分类</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">摄影相册</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">音符空间</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">我的留言</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">旅行简记</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">关于我们</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">联系我们</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">后端开发</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">前端开发</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">其它记录</span></a></li><li class="nav-mobile__item not-black"><a itemprop="url" href="javascript:;" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">旅行生活</span></a></li></ul></nav> <div class="container-fluid-outside wrapper-body__nm"><header itemscope="itemscope" itemtype="https://schema.org/Organization" class="header"><!----> <div class="row header-top"><div class="column xs-33 sm-20"><div class="hamburguer header-top__hamburguer"><div class="hamburguer__wrapper"><span class="hamburguer__line"></span> <span class="hamburguer__line"></span> <span class="hamburguer__line"></span></div></div> <div class="languages header-top__languages"><div class="languages__box"><span class="languages__title meta-text">ZH</span> <span class="languages__icon"></span></div> <ul class="languages__list"><li class="languages__item"><a href="/" class="languages__link router-link-active">
        English
      </a></li><li class="languages__item"><a href="/zh/posts/qian-duan-xing-neng-you-hua-zhi-javascript.html" aria-current="page" class="languages__link router-link-exact-active router-link-active">
        Chinese
      </a></li></ul></div></div> <div class="column xs-33 sm-60"><div class="header__logo"><a href="/zh/" itemprop="url" class="header-top-logo__link router-link-active"><img itemprop="logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAyCAMAAAD7sXLbAAABDlBMVEUAAAA0SV00SFw0SF40SV40SF40SF0wQGA1SF2u6eau1dQ0SF01RVq+0tbfcZSuxsqwx8qtwcYzSF6y5d4wSGDpdJis3dmwztE1SV40SF2ntMCz4980R16tzs/TbpGov8Wxu8PDa4qtwcQ0SV3GaYqnu8Go0tKxv8avZII1SF2+ztS6z9XzeZ41SV6p7ubwdprki6ep6+Sx392r5+Ku5OBafok9Vmk5SV/EwcnNscDbmbF5qq/ohqTmc5eKXHh0WHJoVG670NOT0M2Gvr5ok5vWb5LLbY7AaYq1Z4erZIRGY3NuVnBDTGKg49y219eV0s+PyceMxsXJt8JwnaPUh6Lse51iiJKhYoBNbHtcUWoRJ6B1AAAALXRSTlMAwECA7+C/EJ8N828wH/3f1KBfNSD+9PPPsEwb8O7e27iUk4+BgH5sZmBTMBV50rNAAAABnUlEQVRIx42U51rCMBSGYymljAICMsS9V1paCihDEBFUcO/7vxEreTBtZt+ffd4m3zknCZiT06JQrSggHKkyRGhKKF1Fdtg/otCPXpDoEUgQiQl9FZKoSYGuQAZRfhnHkIlWkMUXlyH3oZpj+UuQj5YS+zR6TOLTvaV8CWVF4MtDyXXcKbmPOyXz6fFJ/O9R4544UwK/eW16PHQaTfxtV+B7OsJ+fvvfRuf6DdPP02IbhfJnk974awCHJoH9MvJ+qZB+68b6491kMex8xgn/0ppzYXLIE34a+U5If4D0msmDyHMniVMM1tvqIf+R5x8E/SnSuzw9QcxLEqdYRT6OI+pOfZl8baei7iQM6j7eIv+VszjpzyyES+vrBsA+cRbalO3s0+8DPgtXpL4ZByy/z67WPQQB9IU/Qf55UM/GOe/zD2u2iVXuez6ml3d3AE2STo+jMFDwPcTNwVEoCv7Rtql50kTxqD4cZNvZKuCSRNcQF2tnToGA2Fp/xZ8mYwAxRxaiVvfs0gmQsjdfv+t6SfIgDGfbG+maU9oy5Oov1sAUptGGixIAAAAASUVORK5CYII=" srcset="/logo/ktquez-play-logo.png 1x, /logo/ktquez-play-logo@2x.png 2x" alt="小窝"></a></div> <meta itemprop="name" content=""> </div> <div class="column xs-33 sm-20"><div class="search header-top__search"><!----> <span class="icon search__icon icon-search"></span></div> <div class="switch-bw header-top__toggle"><span class="switch-bw__text">
    开启夜间模式
  </span> <label for="switch-bw" class="switch-bw__label"><input type="checkbox" id="switch-bw" name="switch-bw" aria-labelledby="switch-bw-text" class="switch-bw__input"> <span class="switch-bw__ball"></span> <span id="switch-bw-text" hidden="hidden">switch to black or white</span></label></div></div></div></header> <div class="container-fluid"><main id="main" itemscope="itemscope" itemtype="https://schema.org/Blog" class="main-page"><div><a href="#main" class="vue-skip-to">跳到主要内容</a> <div><div class="page page__full row justify-right"><article itemscope="itemscope" itemprop="blogPost" itemtype="https://schema.org/BlogPosting" class="column xs-100 page__full__box box-default"><meta itemprop="mainEntityOfPage" content="/zh/posts/qian-duan-xing-neng-you-hua-zhi-javascript.html"> <header class="page-header page__full-header"><button type="button" class="ui-button reset-button back-button"><span class="icon back-button__icon icon--arrow icon-arrow"></span> <span class="back-button__text">返回</span></button> <div class="page-header__meta"><time datetime="Sun May 26 2019 22:00:00 GMT+0800 (GMT+08:00)" itemprop="datePublished" class="text">
            </time> <meta itemprop="dateModified" content="currentPost.updated_at"> <!----></div> <h1 itemprop="name headline" class="page-header__title">前端性能优化之JavaScript</h1> <div class="page-header-cat"><nav class="page-header-cat__nav"><ul class="page-header-cat__list"><li class="page-header-cat__item"><a href="/zh/categories/frontend.html" itemprop="keywords" class="page-header-cat__link meta-text">
                  前端开发
                </a></li></ul></nav></div> <!----> <div itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person" class="page-header__author"><strong>作者: </strong> <a href="/zh/authors/nuochong.html" rel="author" itemprop="url" class="link link--filler-s-primary"><span itemprop="name" class="not-black">诺冲</span></a></div></header> <!----> <!----> <section class="page-content page__full-content"><div class="row"><div class="column no-pad-l sm-50 post-share"><div class="observer" data-v-541be3fd><!----> <!----> <!----></div></div> <!----></div> <div class="row"><div class="column no-pad-l md-75 xl-67 post-content"><div class="post-content__box-player"><!----></div> <div class="post-content__excerpt"><!----></div> <div class="post-content__table-contents"><div class="table-contents"><h3 id="table-of-content" class="table-contents__title">目录</h3> <nav><ol class="table-contents__list"><li class="table-contents__item"><a href="#前言" title="前言" class="table-contents__link"><span>前言</span></a></li><li class="table-contents__item"><a href="#一、加载和运行" title="一、加载和运行" class="table-contents__link"><span>一、加载和运行</span></a></li><li class="table-contents__item"><a href="#脚本位置" title="脚本位置" class="table-contents__link"><span>脚本位置</span></a></li><!----><!----><!----><!----><!----><!----><!----><li class="table-contents__item"><a href="#三、dom-编程" title="三、dom 编程" class="table-contents__link"><span>三、dom 编程</span></a></li><!----><!----><!----><!----><!----><!----><!----><!----><!----><li class="table-contents__item"><a href="#五、字符串和正则表达式-string-and-regular-expression" title="五、字符串和正则表达式 String And Regular Expression" class="table-contents__link"><span>五、字符串和正则表达式 String And Regular Expression</span></a></li><!----><li class="table-contents__item"><a href="#array-prototype-join" title="Array.prototype.join" class="table-contents__link"><span>Array.prototype.join</span></a></li><li class="table-contents__item"><a href="#string-prototype-concat" title="String.prototype.concat" class="table-contents__link"><span>String.prototype.concat</span></a></li><!----><!----><!----><!----><!----><!----><li class="table-contents__item"><a href="#六、响应接口" title="六、响应接口" class="table-contents__link"><span>六、响应接口</span></a></li><!----><!----><!----><li class="table-contents__item"><a href="#七、ajax" title="七、Ajax" class="table-contents__link"><span>七、Ajax</span></a></li><!----><!----><!----><!----><!----><!----><!----><li class="table-contents__item"><a href="#八、编程实践" title="八、编程实践" class="table-contents__link"><span>八、编程实践</span></a></li><!----><!----><li class="table-contents__item"><a href="#九、创建并部署高性能-javascript-应用程序" title="九、创建并部署高性能 JavaScript 应用程序" class="table-contents__link"><span>九、创建并部署高性能 JavaScript 应用程序</span></a></li><!----><li class="table-contents__item"><a href="#后记" title="后记" class="table-contents__link"><span>后记</span></a></li></ol></nav></div></div> <div itemprop="articleBody"><div class="content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>本文为 《高性能 JavaScript》 读书笔记，是利用中午休息时间、下班时间以及周末整理出来的，此书虽有点老旧，但谈论的性能优化话题是每位同学必须理解和掌握的，业务响应速度直接影响用户体验。</p> <h2 id="一、加载和运行"><a href="#一、加载和运行" class="header-anchor">#</a> 一、加载和运行</h2> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>大多数浏览器使用单进程处理 UI 更新和 JavaScript 运行等多个任务，而同一时间只能有一个任务被执行</p></div> <h2 id="脚本位置"><a href="#脚本位置" class="header-anchor">#</a> 脚本位置</h2> <p>将所有<code>script</code>标签放在页面底部，紧靠<code>&lt;/body&gt;</code>上方，以保证页面脚本运行之前完成解析</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
      Hello World
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="defer-async"><a href="#defer-async" class="header-anchor">#</a> defer &amp; async</h3> <p>常规<code>script</code>脚本浏览器会立即加载并执行，异步加载使用<code>async</code>与<code>defer</code>
二者区别在于<code>aysnc</code>为无序，<code>defer</code>会异步根据脚本位置先后依次加载执行</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- file1、file2依次加载 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file1.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file2.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- file1、file2无序加载 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file1.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file2.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="动态脚本"><a href="#动态脚本" class="header-anchor">#</a> 动态脚本</h3> <p>无论在何处启动下载，文件的下载和运行都不会阻塞其他页面处理过程。你甚至可以将这些代码放在<code>&lt;head&gt;</code>部分而不会对其余部分的页面代码造成影响（除了用于下载文件的<code>HTTP</code>连接）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span><span class="token punctuation">;</span>
script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'file1.js'</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'head'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>监听加载函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">loadScript</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>script<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//IE</span>
    script<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>script<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token string">'loaded'</span> <span class="token operator">||</span> script<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token string">'complete'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        script<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//Others</span>
    script<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'head'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="xhr-注入"><a href="#xhr-注入" class="header-anchor">#</a> XHR 注入</h3> <p>前提条件为同域，此处与异步加载一样，只不过使用的是 XMLHttpRequest</p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <ul><li>将所有<code>script</code>标签放在页面底部，紧靠 body 关闭标签上方，以保证页面脚本运行之前完成解析</li> <li>将脚本成组打包，页面 script 标签越少加载越快，响应也就更迅速。不论外部脚本文件或者内联代码都是如此</li></ul> <h3 id="二、数据访问"><a href="#二、数据访问" class="header-anchor">#</a> 二、数据访问</h3> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>数据存储在哪里，关系到代码运行期间数据被检索到的速度. 每一种数据存储位置都具有特定的读写操作负担。大多数情况下，对一个直接量和一个局部变量数据访问的性能差异是微不足道的。</p></div> <h3 id="在-javascript-中有四种基本的数据访问位置"><a href="#在-javascript-中有四种基本的数据访问位置" class="header-anchor">#</a> 在 JavaScript 中有四种基本的数据访问位置：</h3> <ul><li>直接量
直接量仅仅代表自己，而不存储于特定位置。 JavaScript 的直接量包括：字符串，数字，布尔值，对象，数组，函数，正则表达式，具有特殊意义的空值，以及未定义</li> <li>变量
使用 var / let 关键字创建用于存储数据值</li> <li>数组项
具有数字索引，存储一个 JavaScript 数组对象</li> <li>对象成员
具有字符串索引，存储一个 JavaScript 对象</li></ul> <h3 id="总结-2"><a href="#总结-2" class="header-anchor">#</a> 总结</h3> <ul><li>直接量与局部变量访问速度非常快，数组项和对象成员需要更长时间</li> <li>局部变量比域外变量访问速度快，因为它位于作用域链的第一个对象中。变量在作用域链的位置越深，访问所需要的时间越长。全局变量总是最慢的，因为它们总位于作用域链的最后一环。</li> <li>避免使用 with 表达式，因为它改变了运行期上下文的作用域链，谨慎对待 try-catch 表达式中 catch 子句，因为它具有同样的效果</li> <li>嵌套对象成员会造成重大性能影响，尽量少用</li> <li>属性在原型链中的位置越深，访问速度越慢</li> <li>将对象成员、数组项、域外变量存入局部变量能提高 js 代码的性能</li></ul> <h2 id="三、dom-编程"><a href="#三、dom-编程" class="header-anchor">#</a> 三、dom 编程</h2> <p>对 DOM 操作代价昂贵，在富网页应用中通常是一个性能瓶颈。通常处理以下三点</p> <ul><li>访问和修改 DOM 元素</li> <li>修改 DOM 元素的样式，造成重绘和重新排版</li> <li>通过 DOM 事件处理用户响应</li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>一个很形象的比喻是把 DOM 看成一个岛屿，把 JavaScript（ECMAScript）看成另一个岛屿，两者之间以一座收费桥连接（参见 John Hrvatin，微软，MIX09，<a href="http://videos.visitmix.com/MIX09/T53F%EF%BC%89%E3%80%82%E6%AF%8F%E6%AC%A1" target="_blank" rel="noopener noreferrer">http://videos.visitmix.com/MIX09/T53F）。每次<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ECMAScript 需要访问 DOM 时，你需要过桥，交一次 “过桥费”。你操作 DOM 次数越多，费用就越高。一般的建议是尽量减少过桥次数，努力停留在 ECMAScript 岛上。</p></div> <h3 id="dom-访问和修改"><a href="#dom-访问和修改" class="header-anchor">#</a> DOM 访问和修改</h3> <p>访问或修改元素最坏的情况是使用循环执行此操作，特别是在 HTML 集合中使用循环</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">innerHTMLLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>varcount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> count <span class="token operator">&lt;</span> <span class="token number">15000</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'here'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token string">'a'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此函数在循环中更新页面内容。这段代码的问题是，在每次循环单元中都对 DOM 元素访问两次：一次
读取 innerHTML 属性能容，另一次写入它</p> <p>优化如下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">innerHTMLLoop2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> content <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>varcount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> count <span class="token operator">&lt;</span> <span class="token number">15000</span><span class="token punctuation">;</span> count<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    content <span class="token operator">+=</span> <span class="token string">'a'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'here'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>你访问 DOM 越多，代码的执行速度就越慢。因此，一般经验法则是：轻轻地触摸 DOM，并尽量保持在 ECMAScript 范围内</p> <h3 id="节点克隆"><a href="#节点克隆" class="header-anchor">#</a> 节点克隆</h3> <p>使用 DOM 方法更新页面内容的另一个途径是克隆已有 DOM 元素，而不是创建新的——即使用 element.cloneNode()（element 是一个已存在的节点）代替 document.createElement();</p> <h3 id="当布局和几何改变时发生重排版-下述情况会发生"><a href="#当布局和几何改变时发生重排版-下述情况会发生" class="header-anchor">#</a> 当布局和几何改变时发生重排版，下述情况会发生：</h3> <ul><li>添加或删除可见的 DOM 元素</li> <li>元素位置改变</li> <li>元素尺寸改变（边距、填充、边框宽度、宽、高等属性）</li> <li>内容改变（文本或者图片被另一个不同尺寸的所替代）</li> <li>最初的页面渲染</li> <li>浏览器窗口尺寸改变</li></ul> <h3 id="减少重排次数"><a href="#减少重排次数" class="header-anchor">#</a> 减少重排次数</h3> <ul><li>改变 display 属性，临时从文档上移除然后再恢复</li> <li>在文档之外创建并更新一个文档片段，然后将它进行附加</li> <li>先创建更新节点的副本，再操作副本，最后用副本更新老节点</li></ul> <h3 id="总结-3"><a href="#总结-3" class="header-anchor">#</a> 总结</h3> <ul><li>最小化 DOM 访问，在 JavaScript 端做尽可能多的事情</li> <li>在反复访问的地方使用局部变量存放 dom 引用</li> <li>谨慎处理 HTML 集合，因为它们表现‘存在性’，总对底层文档重新查询。将 length 属性缓存到一个变量中，在迭代中使用这个变量。如果经常操作这个集合，可以将集合拷贝到数组中</li> <li>如果可以，使用速度更快的 API，比如 document.querySelectorAll() 和 firstElementChild()</li> <li>注意重绘和重排，批量修改风格，离线操作 DOM，缓存或减少对布局信息的访问</li> <li>动画中使用绝对坐标，使用拖放代理</li> <li>使用事件托管技术中的最小化事件句柄数量</li></ul> <h3 id="四、算法与流程控制"><a href="#四、算法与流程控制" class="header-anchor">#</a> 四、算法与流程控制</h3> <p>代码整体结构是执行速度的决定因素之一。代码量少不一定执行快，代码量多，也不一定执行慢，性能损失与代码组织方式和具体问题解决办法直接相关。</p> <h4 id="loops"><a href="#loops" class="header-anchor">#</a> Loops</h4> <p>在大多数编程语言中，代码执行时间多数在循环中度过。在一系列编程模式中，循环是最常见的模式之一，提高性能必须控制好循环，死循环和长时间循环会严重影响用户体验。</p> <h4 id="types-of-loops"><a href="#types-of-loops" class="header-anchor">#</a> Types of Loops</h4> <ul><li>for</li> <li>while</li> <li>do while</li> <li>for in</li></ul> <p>前三种循环几乎所有编程语言都能通用，for in 循环遍历对象命名属性（包括自有属性和原型属性）</p> <h3 id="loop-performance"><a href="#loop-performance" class="header-anchor">#</a> Loop Performance</h3> <p>循环性能争论的源头是应当选用哪种循环，在 JS 中 for-in 比其他循环明显要慢（每次迭代都要搜索实例或原型属性），除非对数目不详的对象属性进行操作，否则避免使用 for-in。除开 for-in，选择循环应当基于需求而不是性能</p> <p>减少每次迭代的操作总数可以大幅提高循环的整体性能</p> <p>优化循环：</p> <ul><li>减少对象成员和数组项的查找，比如缓存数组长度，避免每次查找数组 length 属性</li> <li>倒序循环是编程语言中常用的性能优化方法</li></ul> <p>编程中经常会听到此说法，现在来验证一下，测试样例</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> start <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'倒序循环耗时：%s ms'</span><span class="token punctuation">,</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//约180 ms</span>
<span class="token keyword">var</span> start <span class="token operator">=</span> <span class="token operator">+</span><span class="token function">newDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'正序序循环耗时：%s ms'</span><span class="token punctuation">,</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//约788 ms</span>
</code></pre></div><h4 id="基于函数的迭代"><a href="#基于函数的迭代" class="header-anchor">#</a> 基于函数的迭代</h4> <p>尽管基于函数的迭代显得更加便利，它还是比基于循环的迭代要慢一些。每个数组项要关联额外的函数调用是造成速度慢的原因。在所有情况下，基于函数的迭代占用时间是基于循环的迭代的八倍，因此在关注执行时间的情况下它并不是一个合适的办法。</p> <h3 id="条件表达式"><a href="#条件表达式" class="header-anchor">#</a> 条件表达式</h3> <p><code>if-else VS switch</code>
使用 if-else 或者 switch 的流行理论是基于测试条件的数量：条件数量较大，倾向使用 switch，更易于阅读
当条件体增加时，if-else 性能负担增加的程度比 switch 更多。
一般来说，if-else 适用于判断两个离散的值或者几个不同的值域，如果判断条件较多 switch 表达式将是更理想的选择</p> <p><code>优化 if-else</code></p> <ul><li>最小化找到正确分支：将最常见的条件放在首位</li> <li>查表法 当使用查表法时，必须完全消除所有条件判断，操作转换成一个数组项查询或者一个对象成员查询。</li></ul> <h4 id="递归"><a href="#递归" class="header-anchor">#</a> 递归</h4> <p>会受浏览器调用栈大小的限制</p> <h4 id="迭代"><a href="#迭代" class="header-anchor">#</a> 迭代</h4> <p>任何可以用递归实现的算法可以用迭代实现。使用优化的循环替代长时间运行的递归函数可以提高性能，因为运行一个循环比反复调用一个函数的开销要低</p> <p>斐波那契</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>制表</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//制表</span>
<span class="token keyword">function</span> <span class="token function">memorize</span><span class="token punctuation">(</span><span class="token parameter">fundamental<span class="token punctuation">,</span> cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  cache <span class="token operator">=</span> cache <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">shell</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cache<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fundamental</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> shell<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//动态规划</span>
<span class="token keyword">function</span> <span class="token function">fibonacciOptimize</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> return1<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> return2<span class="token punctuation">;</span>
  <span class="token keyword">var</span> current <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> previous <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> temp <span class="token operator">=</span> current<span class="token punctuation">;</span>
    current <span class="token operator">=</span> previous <span class="token operator">+</span> current<span class="token punctuation">;</span>
    previous <span class="token operator">=</span> temp<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> current<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//计算阶乘</span>
<span class="token keyword">var</span> res1 <span class="token operator">=</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> res2 <span class="token operator">=</span> <span class="token function">memorize</span><span class="token punctuation">(</span>fibonacci<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> res3 <span class="token operator">=</span> <span class="token function">fibonacciOptimize</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//计算出来的res3优于res2，res2优于res1</span>
</code></pre></div><h3 id="总结-4"><a href="#总结-4" class="header-anchor">#</a> 总结</h3> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>运行代码的总量越大，优化带来的性能提升越明显
正如其他编程语言，代码的写法与算法选用影响 JS 的运行时间，与其他编程语言不同，JS 可用资源有限，所以优化固然重要</p></div> <ul><li>for, while, do while 循环的性能特性相似，谁也不比谁更快或更慢</li> <li>除非要迭代遍历一个属性未知的对象，否则不要使用 for-in 循环</li> <li>改善循环的最佳方式减少每次迭代中的运算量，并减少循环迭代次数</li> <li>一般来说 switch 总比 if-else 更快，但总不是最好的解决方法</li> <li>当判断条件较多，查表法优于 if-else 和 switch</li> <li>浏览器的调用栈大小限制了递归算法在 js 中的应用，栈溢出导致其他代码不能正常执行</li> <li>如果遇到栈溢出，将方法修改为制表法，可以避免重复工作</li></ul> <h2 id="五、字符串和正则表达式-string-and-regular-expression"><a href="#五、字符串和正则表达式-string-and-regular-expression" class="header-anchor">#</a> 五、字符串和正则表达式 String And Regular Expression</h2> <p>在 JS 中，正则是必不可少的东西，它的重要性远远超过烦琐的字符串处理</p> <h3 id="字符串链接-stirng-concatenation"><a href="#字符串链接-stirng-concatenation" class="header-anchor">#</a> 字符串链接 Stirng Concatenation</h3> <p>字符串连接表现出惊人的性能紧张。通常一个任务通过一个循环，向字符串末尾不断地添加内容，来创建一个字符串（例如，创建一个 HTML 表或者一个 XML 文档），但此类处理在一些浏览器上表现糟糕而遭人痛恨</p> <div class="table-container"><table id="table-9" class="table table-striped"><thead><tr><th style="text-align:left;">Method</th> <th style="text-align:left;">Example</th></tr></thead> <tbody><tr><td style="text-align:left;">+</td> <td style="text-align:left;">str = ‘a’ + ‘b’ + ‘c’;</td></tr> <tr><td style="text-align:left;">+=</td> <td style="text-align:left;">str = ‘a’;</td></tr> <tr><td style="text-align:left;">str</td> <td style="text-align:left;">+= ‘b’;</td></tr> <tr><td style="text-align:left;">str</td> <td style="text-align:left;">+= ‘c’;</td></tr> <tr><td style="text-align:left;">array.join()</td> <td style="text-align:left;">str = ,‘b’,‘c’.join(’’);</td> <td></td></tr> <tr><td style="text-align:left;">string.concat()</td> <td style="text-align:left;">str = ‘a’;</td></tr> <tr><td style="text-align:left;"></td> <td style="text-align:left;">str = str.concat(‘b’, ‘c’);</td></tr></tbody></table></div> <p>当连接少量的字符串，上述的方式都很快，可根据自己的习惯使用；
当合并字符串的长度和数量增加之后，有些函数就开始发挥其作用了</p> <p>###<code>+ &amp; +=</code></p> <div class="language-js extra-class"><pre class="language-js"><code>str <span class="token operator">+=</span> <span class="token string">'a'</span> <span class="token operator">+</span> <span class="token string">'b'</span><span class="token punctuation">;</span>
</code></pre></div><p>此代码执行时，发生四个步骤</p> <ol><li>内存中创建了一个临时字符串</li> <li>临时字符串的值被赋予’ab’</li> <li>临时串与 str 进行连接</li> <li>将结果赋予 str</li></ol> <p>下面的代码通过两个离散的表达式直接将内容附加在 str 上避免了临时字符串</p> <div class="language-js extra-class"><pre class="language-js"><code>str <span class="token operator">+=</span> <span class="token string">'a'</span><span class="token punctuation">;</span>
str <span class="token operator">+=</span> <span class="token string">'b'</span><span class="token punctuation">;</span>
</code></pre></div><p>事实上用一行代码就可以解决</p> <div class="language-js extra-class"><pre class="language-js"><code>str <span class="token operator">=</span> str <span class="token operator">+</span> <span class="token string">'a'</span> <span class="token operator">+</span> <span class="token string">'b'</span><span class="token punctuation">;</span>
</code></pre></div><p>赋值表达式以 str 开头，一次追加一个字符串，从左至右依次连接。如果改变了连接顺序（例如：<code>str = 'a' + str + 'b'）</code>, 你会失去这种优化，这与浏览器合并字符串时分配内存的方法有关。除 IE 外，浏览器尝试扩展表达式左端字符串的内存，然后简单地将第二个字符串拷贝到它的尾部。如果在一个循环中，基本字符串在左端，可以避免多次复制一个越来越大的基本字符串。</p> <h2 id="array-prototype-join"><a href="#array-prototype-join" class="header-anchor">#</a> Array.prototype.join</h2> <p>Array.prototype.join 将数组的所有元素合并成一个字符串，并在每个元素之间插入一个分隔符字符串。若传递一个空字符串，可将数组的所有元素简单的拼接起来</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;I'm a thirty-five character string.&quot;</span><span class="token punctuation">,</span>
  newStr <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
  appends <span class="token operator">=</span> <span class="token number">5000000</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>appends<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  newStr <span class="token operator">+=</span> str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> time <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'耗时：'</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">'ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//耗时：1360ms</span>
<span class="token keyword">var</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;I'm a thirty-five character string.&quot;</span><span class="token punctuation">,</span>
  strs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  newStr <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
  appends <span class="token operator">=</span> <span class="token number">5000000</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>appends<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  strs<span class="token punctuation">[</span>strs<span class="token punctuation">.</span>length<span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
newStr <span class="token operator">=</span> strs<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> time <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'耗时：'</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">'ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//耗时：414ms</span>
</code></pre></div><p>这一难以置信的改进结果是因为避免了重复的内存分配和拷贝越来越大的字符串。</p> <h2 id="string-prototype-concat"><a href="#string-prototype-concat" class="header-anchor">#</a> String.prototype.concat</h2> <p>原生字符串连接函数接受任意数目的参数，并将每一个参数都追加在调用函数的字符串上</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> array<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>大多数情况下 concat 比简单的 + 或 += 慢一些</p> <h3 id="regular-expression-optimization-正则表达式优化"><a href="#regular-expression-optimization-正则表达式优化" class="header-anchor">#</a> Regular Expression Optimization 正则表达式优化</h3> <p>许多因素影响正则表达式的效率，首先，正则适配的文本千差万别，部分匹配时比完全不匹配所用的时间要长，每种浏览器的正则引擎也有不同的内部优化</p> <p>正则表达式工作原理</p> <ol><li><p>编译
当你创建了一个正则表达式对象之后（使用一个正则表达式直接量或者 RegExp 构造器），浏览器检查你的模板有没有错误，然后将它转换成一个本机代码例程，用执行匹配工作。如果你将正则表达式赋给一个变量，你可以避免重复执行此步骤。</p></li> <li><p>设置起始位置
当一个正则表达式投入使用时，首先要确定目标字符串中开始搜索的位置。它是字符串的起始位置，或者由正则表达式的 lastIndex 属性指定，但是当它从第四步返回到这里的时候（因为尝试匹配失败），此位置将位于最后一次尝试起始位置推后一个字符的位置上</p></li> <li><p>匹配每个正则表达式的字元
正则表达式一旦找好起始位置，它将一个一个地扫描目标文本和正则表达式模板。当一个特定字元匹配失败时，正则表达式将试图回溯到扫描之前的位置上，然后进入正则表达式其他可能的路径上</p></li> <li><p>匹配成功或失败
如果在字符串的当前位置上发现一个完全匹配，那么正则表达式宣布成功。如果正则表达式的所有可能路径都尝试过了，但是没有成功地匹配，那么正则表达式引擎回到第二步，从字符串的下一个字符重新尝试。只有字符串中的每个字符（以及最后一个字符后面的位置）都经历了这样的过程之后，还没有成功匹配，那么正则表达式就宣布彻底失败。</p></li></ol> <h3 id="理解回溯"><a href="#理解回溯" class="header-anchor">#</a> 理解回溯</h3> <p>在大多数现代正则表达式实现中（包括 JavaScript 所需的），回溯是匹配过程的基本组成部分。它很大程度上也是正则表达式如此美好和强大的根源。然而，回溯计算代价昂贵，如果你不够小心的话容易失控。虽然回溯是整体性能的唯一因素，理解它的工作原理，以及如何减少使用频率，可能是编写高效正则表达式最重要的关键点。</p> <p>正则表达式匹配过程</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <ul><li>当一个正则表达式扫描目标字符串时，它从左到右逐个扫描正则表达式的组成部分，在每个位置上测试能不能找到一个匹配。对于每一个量词和分支，都必须决定如何继续进行。如果是一个量词（诸如 *，+?，或者 {2,}），正则表达式必须决定何时尝试匹配更多的字符；如果遇到分支（通过 | 操作符），它必须从这些选项中选择一个进行尝试。</li> <li>每当正则表达式做出这样的决定，如果有必要的话，它会记住另一个选项，以备将来返回后使用。如果所选方案匹配成功，正则表达式将继续扫描正则表达式模板，如果其余部分匹配也成功了，那么匹配就结束了。但是如果所选择的方案未能发现相应匹配，或者后来的匹配也失败了，正则表达式将回溯到最后一个决策点，然后在剩余的选项中选择一个。它继续这样下去，直到找到一个匹配，或者量词和分支选项的所有可能的排列组合都尝试失败了，那么它将放弃这一过程，然后移动到此过程开始位置的下一个字符上，重复此过程。</li></ul></div> <p>示例分析</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">h(ello|appy) hippo</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'hello there, happy hippo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>此正则表达式匹配 “hello hippo” 或“happy hippo”。测试一开始，它要查找一个 h，目标字符串的第一个字母恰好就是 h，它立刻就被找到了。接下来，子表达式（ello|appy）提供了两个处理选项。正则表达式选择最左边的选项（分支选择总是从左到右进行），检查 ello 是否匹配字符串的下一个字符。确实匹配，然后正则表达式又匹配了后面的空格。然而在这一点上它走进了死胡同，因为 hippo 中的 h 不能匹配字符串中的下一个字母 t。此时正则表达式还不能放弃，因为它还没有尝试过所有的选择，随后它回溯到最后一个检查点（在它匹配了首字母 h 之后的那个位置上）并尝试匹配第二个分支选项。但是没有成功，而且也没有更多的选项了，所以正则表达式认为从字符串的第一个字符开始匹配是不能成功的，因此它从第二个字符开始，重新进行查找。它没有找到 h，所以就继续向后找，直到第 14 个字母才找到，它匹配 happy 的那个 h。然后它再次进入分支过程。这次 ello 未能匹配，但是回溯之后第二次分支过程中，它匹配了整个字符串“happy hippo”（如图 5-4）。匹配成功了。</p> <h3 id="回溯失控"><a href="#回溯失控" class="header-anchor">#</a> 回溯失控</h3> <p>当一个正则表达式占用浏览器上秒，上分钟或者更长时间时，问题原因很可能是回溯失控。正则表达式处理慢往往是因为匹配失败过程慢，而不是匹配成功过程慢。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> reg<span class="token operator">=</span><span class="token operator">/</span><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span>title<span class="token operator">&gt;</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">html&gt;</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token comment">//优化如下</span>
<span class="token keyword">var</span> regOptimize<span class="token operator">=</span><span class="token operator">/</span><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span>title<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>sS<span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">?</span><span class="token operator">&lt;</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">html&gt;</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
</code></pre></div><p>现在如果没有尾随的那么最后一个 [sS]*? 将扩展至字符串结束，正则表达式将立刻失败因为没有回溯点可以返回</p> <h3 id="提高正则表达式效率的更多方法"><a href="#提高正则表达式效率的更多方法" class="header-anchor">#</a> 提高正则表达式效率的更多方法</h3> <ul><li>关注如何让匹配更快失败</li> <li>正则表达式以简单的，必需的字元开始</li> <li>编写量词模板，使它们后面的字元互相排斥</li> <li>减少分支的数量，缩小它们的范围</li> <li>使用非捕获组</li> <li>捕获感兴趣的文字，减少后处理</li> <li>暴露所需的字元</li> <li>使用适当的量词</li> <li>将正则表达式赋给变量，以重用它们</li> <li>将复杂的正则表达式拆分为简单的片断</li> <li>什么时候不应该使用正则表达式</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> endsWithSemicolon <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">;$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你可能觉得很奇怪，虽说当前没有哪个浏览器聪明到这个程度，能够意识到这个正则表达式只能匹配字符串的末尾。最终它们所做的将是一个一个地测试了整个字符串。字符串的长度越长（包含的分号越多），它占用的时间也越长</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> endsWithSemicolon <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">';'</span><span class="token punctuation">;</span>
</code></pre></div><p>这种情况下，更好的办法是跳过正则表达式所需的所有中间步骤，简单地检查最后一个字符是不是分号：</p> <p>这个例子使用 charAt 函数在特定位置上读取字符。字符串函数 slice，substr，和 substring 可用于在特定位置上提取并检查字符串的值</p> <p>所有这些字符串操作函数速度都很快，当您搜索那些不依赖正则表达式复杂特性的文本字符串时，它们有助于您避免正则表达式带来的性能开销</p> <h3 id="字符串修剪"><a href="#字符串修剪" class="header-anchor">#</a> 字符串修剪</h3> <p>正则表达式允许你用很少的代码实现一个修剪函数，这对 JavaScript 关心文件大小的库来说十分重要。可能最好的全面解决方案是使用两个子表达式：一个用于去除头部空格，另一个用于去除尾部空格。这样处理简单而迅速，特别是处理长字符串时。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//方法 用正则表达式修剪</span>
<span class="token comment">// trim1</span>
<span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^s+</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">s+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//trim2</span>
<span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^s+|s+$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// trim 3</span>
<span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^s*([sS]*?)s*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// trim 4</span>
<span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^s*([sS]*S)?s*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// trim 5</span>
<span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^s*(S*(s+S+)*)s*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//方法二 不使用正则表达式修剪</span>
<span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> end <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token comment">//ws 变量包括 ECMAScript 5 中定义的所有空白字符</span>
  <span class="token keyword">var</span> ws <span class="token operator">=</span> '	  ᠎           
   　﻿'<span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    start<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;</span> start <span class="token operator">&amp;&amp;</span> ws<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    end<span class="token operator">--</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//方法三 混合解决方案</span>
<span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">trim</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^s+</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    end <span class="token operator">=</span> str<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
    ws <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">s</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    end<span class="token operator">--</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>简单地使用两个子正则表达式在所有浏览器上处理不同内容和长度的字符串时，均表现出稳定的性能。因此它可以说是最全面的解决方案。混合解决方案在处理长字符串时特别快，其代价是代码稍长，在某些浏览器上处理尾部长空格时存在弱点</p> <h3 id="总结-5"><a href="#总结-5" class="header-anchor">#</a> 总结</h3> <ul><li>使用简单的 + 和 += 取代数组联合，可避免（产生）不必要的中间字符串</li> <li>当连接数量巨大或尺寸巨大的字符串时，使用数组联合</li> <li>使相邻字元互斥，避免嵌套量词对一个字符串的相同部分多次匹配，通过重复利用前瞻操作的原子特性去除不必要的回溯</li></ul> <h2 id="六、响应接口"><a href="#六、响应接口" class="header-anchor">#</a> 六、响应接口</h2> <p>用户倾向于重复尝试这些不发生明显变化的动作，所以确保网页应用程序的响应速度也是一个重要的性能关注点</p> <h3 id="浏览器-ui-线程"><a href="#浏览器-ui-线程" class="header-anchor">#</a> 浏览器 UI 线程</h3> <p>JavaScript 和 UI 更新共享的进程通常被称作浏览器 UI 线程, UI 线程围绕着一个简单的队列系统工作，任务被保存到队列中直至进程空闲。一旦空闲，队列中的下一个任务将被检索和运行。这些任务不是运行 JavaScript 代码，就是执行 UI 更新，包括重绘和重排版.
大多数浏览器在 JavaScript 运行时停止 UI 线程队列中的任务，也就是说 JavaScript 任务必须尽快结束，以免对用户体验造成不良影响</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>Brendan Eich，JavaScript 的创造者，引用他的话说，“[JavaScript] 运行了整整几秒钟很可能是做错了什么……”</p></div> <p>定时器基础
定时器与 UI 线程交互的方式有助于分解长运行脚本成为较短的片断</p> <h3 id="定时器精度"><a href="#定时器精度" class="header-anchor">#</a> 定时器精度</h3> <p>所有浏览器试图尽可能准确，但通常会发生几毫秒滑移，或快或慢。正因为这个原因，定时器不可用于测量实际时间</p> <h3 id="总结-6"><a href="#总结-6" class="header-anchor">#</a> 总结</h3> <ul><li>JavaScript 运行时间不应该超过 100 毫秒。过长的运行时间导致 UI 更新出现可察觉的延迟，从而对整体用户体验产生负面影响</li> <li>JavaScript 运行期间，浏览器响应用户交互的行为存在差异。无论如何，JavaScript 长时间运行将导致用户体验混乱和脱节。</li> <li>同一时间只有一个定时器存在，只有当这个定时器结束时才创建一个新的定时器。以这种方式使用定时器不会带来性能问题</li> <li>定时器可用于安排代码推迟执行，它使得你可以将长运行脚本分解成一系列较小的任务</li></ul> <h2 id="七、ajax"><a href="#七、ajax" class="header-anchor">#</a> 七、Ajax</h2> <p>目前最常用的方法中，XMLHttpRequest（XHR）用来异步收发数据。所有现代浏览器都能够很好地支持它，而且能够精细地控制发送请求和数据接收。你可以向请求报文中添加任意的头信息和参数（包括 GET 和 POST），并读取从服务器返回的头信息，以及响应文本自身</p> <h3 id="请求数据"><a href="#请求数据" class="header-anchor">#</a> 请求数据</h3> <p>五种常用技术用于向服务器请求数据</p> <ul><li>XMLHttpRequest (XHR)</li> <li>Dynamic script tag insertion 动态脚本标签插入</li> <li>iframes</li> <li>Comet</li> <li>Multipart XHR 多部分的 XHR</li></ul> <h3 id="xmlhttprequest"><a href="#xmlhttprequest" class="header-anchor">#</a> XMLHttpRequest</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//封装ajax</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> contentType<span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="动态脚本标签插入"><a href="#动态脚本标签插入" class="header-anchor">#</a> 动态脚本标签插入</h3> <h3 id="发送数据"><a href="#发送数据" class="header-anchor">#</a> 发送数据</h3> <ul><li>XMLHttpRequest</li> <li>图像灯标</li></ul> <h3 id="数据格式"><a href="#数据格式" class="header-anchor">#</a> 数据格式</h3> <p>通过 Douglas Crockford 的发明与推广，JSON 是一个轻量级并易于解析的数据格式，它按照 JavaScript 对象和数组字面语法所编写</p> <h3 id="ajax-性能向导"><a href="#ajax-性能向导" class="header-anchor">#</a> Ajax 性能向导</h3> <p>数据传输技术和数据格式</p> <ul><li>缓存数据</li> <li>设置 HTTP 头</li> <li>本地存储数据</li></ul> <h3 id="总结-7"><a href="#总结-7" class="header-anchor">#</a> 总结</h3> <p>高性能 Ajax 包括：知道你项目的具体需求，选择正确的数据格式和与之相配的传输技术</p> <ul><li>减少请求数量，可合并 js 和 css 文件</li> <li>缩短页面的加载时间，在页面其它内容加载之后，使用 Ajax 获取少量重要文件</li> <li>JSON 是高性能 AJAX 的基础，尤其在使用动态脚本注入时</li> <li>学会何时使用一个健壮的 Ajax 库，何时编写自己的底层 Ajax 代码</li></ul> <p>封装自己的 ajax 库</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">root</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  root<span class="token punctuation">.</span><span class="token function-variable function">MyAjax</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> url <span class="token operator">=</span> config<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
    <span class="token keyword">let</span> type <span class="token operator">=</span> config<span class="token punctuation">.</span>type <span class="token operator">||</span> <span class="token string">'GET'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> async <span class="token operator">=</span> config<span class="token punctuation">.</span>async <span class="token operator">||</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> headers <span class="token operator">=</span> config<span class="token punctuation">.</span>headers <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> contentType <span class="token operator">=</span> config<span class="token punctuation">.</span>contentType <span class="token operator">||</span> <span class="token string">'application/json;charset=utf-8'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> config<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token keyword">let</span> dataType <span class="token operator">=</span> config<span class="token punctuation">.</span>dataType <span class="token operator">||</span> <span class="token string">'json'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> successFn <span class="token operator">=</span> config<span class="token punctuation">.</span>success<span class="token punctuation">;</span>
    <span class="token keyword">let</span> errorFn <span class="token operator">=</span> config<span class="token punctuation">.</span>error<span class="token punctuation">;</span>
    <span class="token keyword">let</span> completeFn <span class="token operator">=</span> config<span class="token punctuation">.</span>complete<span class="token punctuation">;</span>
    <span class="token keyword">let</span> xhr<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      xhr <span class="token operator">=</span> <span class="token function">newXMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      xhr <span class="token operator">=</span> <span class="token function">newActiveXObject</span><span class="token punctuation">(</span><span class="token string">'Microsoft.XMLHTTP'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> rsp <span class="token operator">=</span> xhr<span class="token punctuation">.</span>responseText <span class="token operator">||</span> xhr<span class="token punctuation">.</span>responseXML<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>dataType <span class="token operator">===</span> <span class="token string">'json'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            rsp <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'('</span> <span class="token operator">+</span> rsp <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token function">successFn</span><span class="token punctuation">(</span>rsp<span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>statusText<span class="token punctuation">,</span> xhr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token function">errorFn</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>statusText<span class="token punctuation">,</span> xhr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>completeFn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">completeFn</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>statusText<span class="token punctuation">,</span> xhr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> url<span class="token punctuation">,</span> async<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置超时</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>async<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      xhr<span class="token punctuation">.</span>timeout <span class="token operator">=</span> config<span class="token punctuation">.</span>timeout <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//设置请求头</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> headers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span>headers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> headers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> contentType<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//send</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> data <span class="token operator">==</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> contentType <span class="token operator">===</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>attr <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        s <span class="token operator">+=</span> attr <span class="token operator">+</span> <span class="token string">'='</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>attr<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'&amp;'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        s <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="八、编程实践"><a href="#八、编程实践" class="header-anchor">#</a> 八、编程实践</h2> <ul><li>避免二次评估，比如 eval，Function</li> <li>使用对象 / 数组直接量</li> <li>不要重复工作</li> <li>延迟加载</li> <li>条件预加载</li> <li>使用速度快的部分</li> <li>位操作运算符
四种位逻辑操作符</li> <li>位与
比如判断数奇偶</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>jsnum <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//取模与0进行判断num &amp; 1; //位与1结果位1则为奇数，为0则为偶数</span>
</code></pre></div><ul><li>位或</li> <li>位异或</li> <li>位非</li> <li>位掩码
位掩码在计算机科学中是一种常用的技术，可同时判断多个布尔 选项，快速地将数字转换为布尔标志数组。掩码中每个选项的值都等于 2 的幂</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token constant">OPTION_A</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token constant">OPTION_B</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token constant">OPTION_C</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token constant">OPTION_D</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token constant">OPTION_E</span> <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
</code></pre></div><p>通过定义这些选项，你可以用位或操作创建一个数字来包含多个选项：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token constant">OPTION_A</span> <span class="token operator">|</span> <span class="token constant">OPTION_C</span> <span class="token operator">|</span> <span class="token constant">OPTION_D</span><span class="token punctuation">;</span>
<span class="token comment">// 可以使用位与操作检查一个给定的选项是否可用;</span>
<span class="token comment">//is option A in the list?</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;</span> <span class="token constant">OPTION_A</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//do something</span>
<span class="token punctuation">}</span>
<span class="token comment">//is option B in the list?</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;</span> <span class="token constant">OPTION_B</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//do something</span>
<span class="token punctuation">}</span>
</code></pre></div><p>像这样的位掩码操作非常快，正因为前面提到的原因，操作发生在系统底层。如果许多选项保存在一起并经常检查，位掩码有助于加快整体性能</p> <h3 id="原生方法"><a href="#原生方法" class="header-anchor">#</a> 原生方法</h3> <p>无论你怎样优化 JavaScript 代码，它永远不会比 JavaScript 引擎提供的原生方法更快。经验不足的 JavaScript 开发者经常犯的一个错误是在代码中进行复杂的数学运算，而没有使用内置 Math 对象中那些性能更好的版本。Math 对象包含专门设计的属性和方法，使数学运算更容易。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//查看Math对象所有方法</span>
Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>Math<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="总结-8"><a href="#总结-8" class="header-anchor">#</a> 总结</h3> <ul><li>通过避免使用 eval() 和 Function() 构造器避免二次评估。此外，给 setTimeout() 和 setInterval() 传递函数参数而不是字符串参数。</li> <li>创建新对象和数组时使用对象直接量和数组直接量。它们比非直接量形式创建和初始化更快。</li> <li>避免重复进行相同工作。当需要检测浏览器时，使用延迟加载或条件预加载</li> <li>当执行数学远算时，考虑使用位操作，它直接在数字底层进行操作。</li> <li>原生方法总是比 JavaScript 写的东西要快。尽量使用原生方法</li></ul> <h2 id="九、创建并部署高性能-javascript-应用程序"><a href="#九、创建并部署高性能-javascript-应用程序" class="header-anchor">#</a> 九、创建并部署高性能 JavaScript 应用程序</h2> <ul><li>合并 js 文件，减少 HTTP 请求的数量</li> <li>以压缩形式提供 js 文件（gzip 编码）</li> <li>通过设置 HTTP 响应报文头使 js 文件可缓存，通过向文件名附加时间戳解决缓存问题</li> <li>使用 CDN 提供 js 文件，CDN 不仅可以提高性能，它还可以为你管理压缩和缓存</li></ul> <h3 id="十、工具"><a href="#十、工具" class="header-anchor">#</a> 十、工具</h3> <p>当网页或应用程序变慢时，分析网上传来的资源，分析脚本的运行性能，使你能够集中精力在那些需要努力优化的地方。</p> <ul><li>使用网络分析器找出加载脚本和其它页面资源的瓶颈所在，这有助于决定哪些脚本需要延迟加载，或者进行进一步分析</li> <li>尽量延迟加载脚本以使页面渲染速度更快，向用户提供更好的整体体验。</li> <li>使用性能分析器找出脚本运行时速度慢的部分，检查每个函数所花费的时间，以及函数被调用的次数，通过调用栈自身提供的一些线索来找出哪些地方应当努力优化</li></ul> <h2 id="后记"><a href="#后记" class="header-anchor">#</a> 后记</h2> <p>能读到最后的同学也不容易，毕竟篇幅稍长。本书大概花了三周的零碎时间读完，建议大家读一读。如果大家在看书过程中存在疑问，不妨打开电脑验证书中作者的言论，或许会更加深刻。</p> <p><a href="https://mp.weixin.qq.com/s/--oFuhjxeymE0vdTZtmiJg" target="_blank" rel="noopener noreferrer">前端性能优化之 JavaScript<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div></div> <div id="shangfang" class="column no-pad-r sm-25 xl-33 xsNone smNone post-sidebar"><div class="ads-container"><!----></div> <!----> <div id="zhongjian"><div class="table-contents-fixed"><h3 id="table-of-content" class="table-contents__title">浮动目录</h3> <nav><ol class="table-contents__list"></ol></nav></div></div></div> <aside id="dibujuli" class="column xs-100"><hr class="divider"> <div><div class="observer" data-v-541be3fd><!----> <!----> <!----></div></div> <hr class="divider"> <section class="post-content__disqus"><Vssue name="前端性能优化之JavaScript"></Vssue></section></aside></div></section></article></div> <section class="row section-newsletter justify-center newsletter-post-wrap"><div class="column sm-100 md-67 xl-50"><div class="newsletter not-black"><span class="meta-text meta-text--primary not-black">关注我们</span> <h2 class="newsletter__title not-black">在收件箱接收新的内容推送</h2> <form method="post" action="https://luzhaoyang.us4.list-manage.com/subscribe/post?u=1de83ba90307cf0e38650d622&amp;amp;id=04aeba270a" class="newsletter__form not-black"><label for="email_news-1660882756809" class="newsletter__label not-black"><input type="email" name="EMAIL" id="email_news-1660882756809" required="required" placeholder="在这里输入您的电子邮件" autocomplete="off" aria-label="在这里输入您的电子邮件" value="" class="ui-input-field reset-input newsletter__input"></label> <button type="submit" class="ui-button reset-button newsletter__button txt-upper ui-button--primary">
        订阅
      </button></form></div></div></section> <aside class="container main"></aside></div> <!----> <div><div class="elevator"><a class="elevator__link"><span class="icon elevator__icon icon-greaterthan"></span> <!----></a> <!----></div> <div class="mask-container"><div class="mask-wrap"><div class="circle-wrapper"><svg xmlns="http://www.w3.org/200/svg" height="100%" width="100%"><circle cx="66" cy="66" r="55" fill="none" stroke="#FF4437" stroke-width="5" stroke-linecap="round" class="circle-full"></circle> <circle cx="66" cy="66" r="55" fill="none" stroke-width="5" stroke-linecap="round" stroke="#FF4437" stroke-dasharray="0,10000" class="circle-detail"></circle></svg> <img class="mobile-bgm-img coupon-num had-percent"></div> <div></div> <div></div> <div class="mobile-bgm-list"><i class="reco-bgm reco-bgm-last last mobile-bgm-btn"></i> <i class="reco-bgm reco-bgm-pause pause mobile-bgm-btn" style="display:none;"></i> <i class="reco-bgm reco-bgm-play play mobile-bgm-btn" style="display:;"></i> <i class="reco-bgm reco-bgm-next next mobile-bgm-btn"></i></div> <div class="mobile-bgm-close"><i class="iconfont iconLogonClosed mobile-bgm-btn"></i></div></div></div></div> <!----></div></main></div> <footer id="footer" class="footer "><div class="footer-box1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1366 161" class="footer-box__shape"><path d="M-11.925-4809v-154.746c40.454,19.75,273.683,130.936,420.544,142.612,161.25,12.821,339.978-42.709,521.543-86.3,169.82-40.769,395.43,29.2,423.912,38.429v60Z" transform="translate(11.926 4970)"></path></svg></div> <div class="footer-box2"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1366 246" class="footer-box__shape"><path d="M-1505.5-4725.5v-238.1c8.149-3.133,18.138-5.059,29.672-5.9h30.954c201.21,11.667,696.6,224.535,855.572,236.458,205.129,15.385,287.179-164.1,432.047-175.625a42.381,42.381,0,0,1,16.756,1.857V-4725.5Z" transform="translate(1506 4971)"></path></svg> <ul class="footer-social__list"></ul> <div class="footer-newsletter not-black"><div class="newsletter not-black"><span class="meta-text meta-text--primary not-black">关注我们</span> <h2 class="newsletter__title not-black">在收件箱接收新的内容推送</h2> <form method="post" action="https://luzhaoyang.us4.list-manage.com/subscribe/post?u=1de83ba90307cf0e38650d622&amp;amp;id=04aeba270a" class="newsletter__form not-black"><label for="email_news-1660882756811" class="newsletter__label not-black"><input type="email" name="EMAIL" id="email_news-1660882756811" required="required" placeholder="在这里输入您的电子邮件" autocomplete="off" aria-label="在这里输入您的电子邮件" value="" class="ui-input-field reset-input newsletter__input"></label> <button type="submit" class="ui-button reset-button newsletter__button txt-upper ui-button--primary">
        订阅
      </button></form></div></div></div> <section class="footer-box3"><div class="row"><div class="column sm-50 footer-card"><div class="observer" data-v-541be3fd><div class="spinner observer__spinner" data-v-541be3fd><div class="double-bounce1"></div> <div class="double-bounce2"></div></div> <!----> <!----></div></div> <div class="column sm-50 footer-nav"><div class="row justify-right"><div class="column xs-50 sm-40 md-33 footer-nav__box footer-nav__box--1 not-black"><h2 class="meta-text title not-black">我的小窝</h2> <nav class="footer-nav1"><ul><li class="footer-nav1__item"><a href="javascript:;" class="not-black">文章分类</a> <!----></li><li class="footer-nav1__item"><a href="javascript:;" class="not-black">摄影相册</a> <!----></li><li class="footer-nav1__item"><a href="javascript:;" class="not-black">音符空间</a> <!----></li><!----><li class="footer-nav1__item"><a href="javascript:;" class="not-black">旅行简记</a> <!----></li><li class="footer-nav1__item"><a href="javascript:;" class="not-black">关于我们</a> <!----></li><li class="footer-nav1__item"><a href="javascript:;" class="not-black">联系我们</a> <!----></li></ul></nav></div> <div class="column xs-50 sm-40 md-33 footer-nav__box footer-nav__box--2"><h2 class="meta-text title not-black">社区</h2> <nav class="footer-nav2"><ul><li class="footer-nav2__item"><!----> <a href="https://jq.qq.com/?_wv=1027&amp;k=5sOoWzp" rel="noopener nofollow" target="_blank" class="not-black">Q群 931024509</a></li><li class="footer-nav2__item"><!----> <a href="https://nativescript-vue-examples.luzhaoyang.com/" rel="noopener nofollow" target="_blank" class="not-black">NSVue 示例</a></li><li class="footer-nav2__item"><!----> <a href="https://marketplace.visualstudio.com/items?itemName=nuochong.nativescript-vue-extend" rel="noopener nofollow" target="_blank" class="not-black">NSVue 扩展</a></li><li class="footer-nav2__item"><!----> <a href="https://vue-auto-complete.luzhaoyang.com/" rel="noopener nofollow" target="_blank" class="not-black">Vue Auto Complete</a></li></ul></nav></div></div></div> <div class="cpolumn sm-100 footer-copy"><p class="visitors-total" data-v-504ab208><span data-v-504ab208>累计访问</span> <span data-v-504ab208></span> <span data-v-504ab208>次</span></p> <p class="footer-copy-last">2018 - 2022 © NUOCHONG - 源于 
  <a href="https://github.com/" rel="noopener" target="_blank">
    GITHUB
  </a></p></div></div> <span class="shapes shapes--circle" style="left: 3%; top: -20%"></span> <span class="shapes shapes--primary shapes--color3" style="left: 30%; top: -15%"></span> <span class="shapes shapes--primary" style="left: 13%; top: -80%; transform: rotate(45deg)"></span> <span class="shapes shapes--circle shapes--color4" style="left: 40%; top: 200px"></span> <span class="shapes shapes--primary" style="left: 15%; bottom: 10%; transform: rotate(75deg)"></span> <span class="shapes shapes--circle shapes--color3" style="right: 50%; top: 30%"></span> <span class="shapes shapes--primary" style="right: 20%; top: -100%"></span> <span class="shapes shapes--circle" style="right: 10%; top: -20%"></span> <span class="shapes shapes--color4" style="right: 35%; top: -20%; transform: rotate(45deg)"></span> <span class="shapes shapes--circle" style="left: 40%; top: -50%"></span> <span class="shapes shapes--color3" style="right: 30%; top: 20%"></span> <span class="shapes shapes--circle shapes--primary" style="right: 30%; bottom: 20%"></span></section> <div class="watermark-logo"></div> <canvas width="auto" height="auto" style="position: absolute; left: 0px; bottom: 0px;"></canvas></footer></div> <!----> <!----></div><div class="global-ui"><div><!----> <!----></div><!----></div></div>
    <script src="/assets/js/app.79dcca4c.js" defer></script><script src="/assets/js/33.8d9700f2.js" defer></script><script src="/assets/js/4.a79b566e.js" defer></script><script src="/assets/js/32.6eba47d8.js" defer></script><script src="/assets/js/30.babca846.js" defer></script><script src="/assets/js/35.d6a9423e.js" defer></script><script src="/assets/js/0.8d478666.js" defer></script><script src="/assets/js/3.b2f5dd85.js" defer></script><script src="/assets/js/2.751b6683.js" defer></script><script src="/assets/js/8.88814606.js" defer></script><script src="/assets/js/224.41b0e766.js" defer></script><script src="/assets/js/5.d1231227.js" defer></script><script src="/assets/js/6.b56e5265.js" defer></script><script src="/assets/js/1.119b4490.js" defer></script><script src="/assets/js/14.1b67e6d6.js" defer></script><script src="/assets/js/34.36ec36b6.js" defer></script><script src="/assets/js/31.03d9eabb.js" defer></script><script src="/assets/js/37.b37d633e.js" defer></script>
  </body>
</html>
