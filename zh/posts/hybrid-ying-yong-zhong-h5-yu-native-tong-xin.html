<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hybrid 应用中 H5 与 Native 通信 | 小窝</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/favicon/favicon.ico">
    <link rel="apple-touch-icon" href="/favicon/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#fff">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_1575342_gu630lpigw.css" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.0/baguetteBox.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/css/swiper.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mapbox-gl@1.7.0/dist/mapbox-gl.css" type="text/css">
    <link rel="stylesheet" href="https://www.zhangxinxu.com/study/201903/css-idea/cssgram.min.css" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.firebase.com/js/client/2.0.4/firebase.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/js/swiper.min.js"></script>
    <script src="https://static.runoob.com/assets/qrcode/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/shakee93/vue-toasted@v1.1.27/dist/vue-toasted.min.js"></script>
    <script src="https://cdn.bootcss.com/wow/1.1.2/wow.min.js"></script>
    <script src="https://cdn.bootcss.com/velocity/2.0.5/velocity.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/locale/zh-cn.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mapbox-gl@1.7.0/dist/mapbox-gl.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mapbox/mapbox-gl-language@0.10.1/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/console-badge@1.3.0/dist/console-badge.umd.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/leancloud-storage@4.6.1/dist/av-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>
    <link rel="alternate" type="application/rss+xml" href="https://luzhaoyang.com/rss.xml" title=" RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://luzhaoyang.com/feed.atom" title=" Atom Feed">
    <link rel="alternate" type="application/json" href="https://luzhaoyang.com/feed.json" title=" JSON Feed">
    <meta name="description" content="博客">
    <meta property="article:published_time" content="2020-06-14T04:01:00.000Z">
    <meta property="article:modified_time" content="2020-06-14T04:01:00.000Z">
    <meta property="og:title" content="Hybrid 应用中 H5 与 Native 通信">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://luzhaoyang.com/zh/posts/hybrid-ying-yong-zhong-h5-yu-native-tong-xin.html">
    <meta property="og:image" content="https://luzhaoyang.com/social/image-social-share-zh.png">
    <meta name="twitter:title" content="Hybrid 应用中 H5 与 Native 通信">
    <meta name="twitter:url" content="https://luzhaoyang.com/zh/posts/hybrid-ying-yong-zhong-h5-yu-native-tong-xin.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://luzhaoyang.com/social/image-social-share-zh.png">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="前端开发">
    <meta property="article:tag" content="前端开发">
    <meta name="theme-color" content="#fff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/favicon/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/styles.90ce81ab.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/app.90ce81ab.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/22.styles.f903ac36.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/22.f903ac36.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/4.styles.41ad7137.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/4.41ad7137.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/21.styles.1f1e2633.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/21.1f1e2633.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/20.styles.44838259.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/20.44838259.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/25.styles.cc209185.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/25.cc209185.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/0.styles.77bb68a4.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/0.77bb68a4.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/5.e3e753ea.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/3.styles.16f66127.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/3.16f66127.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/26.styles.8994549d.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/26.8994549d.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/85.e90e94c2.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/6.styles.bb81f560.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/6.bb81f560.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/13.styles.eba3b1f4.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/13.eba3b1f4.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/1.styles.8ab90744.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/1.8ab90744.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/11.styles.bd75290f.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/11.bd75290f.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/23.styles.43371fdf.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/23.43371fdf.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/2.styles.51093229.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/2.51093229.js" as="script"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/28.styles.20b8b74b.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/28.20b8b74b.js" as="script"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/10.styles.8a3f37bc.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/12.styles.d1049df1.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/14.styles.e933a718.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/15.styles.d9c975a1.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/16.styles.b6505673.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/17.styles.a5211f2a.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/18.styles.9a68b3e8.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/19.styles.a90c0925.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/24.styles.abee3e39.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/27.styles.45e781ed.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/32.styles.9ca90e56.css"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/10.8a3f37bc.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/100.ce28738b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/101.e637700c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/102.60da82b5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/103.4f4f95db.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/104.44640ecb.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/105.b756b3ba.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/106.c89db5c5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/107.a2cf165f.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/108.93af546b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/109.485b874d.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/110.9d61dc7a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/111.1184bc62.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/112.2a1acc87.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/113.e9859bae.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/114.0cf96aef.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/115.07cff772.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/116.8ff664ef.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/117.eb388f34.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/118.8b49c2bf.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/119.037e1617.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/12.d1049df1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/120.662489b6.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/121.0739e8c2.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/122.259a051b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/123.b9fbef9b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/124.24b21b82.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/125.172ebfe1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/126.cc15e593.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/127.1c213dae.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/128.41161a21.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/129.f5f5c9d3.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/130.c9a8adee.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/131.13432f35.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/132.b26da9a5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/133.e3d491ce.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/134.fe878b83.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/135.81bd6fd8.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/136.669975be.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/137.909dafe2.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/138.bf5624b9.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/139.cc5c044b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/14.e933a718.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/140.9d7e0e5c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/141.7faa61f3.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/142.6aec6770.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/143.312f91e5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/144.f43171fd.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/145.59e03e1a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/146.38557238.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/147.51076999.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/148.1e0b1408.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/149.bb126c7c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/15.d9c975a1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/150.f38ed01c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/151.2566794d.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/152.5a22c347.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/153.0d3be9bc.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/154.63911ba7.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/155.afe4425a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/156.ef5b38de.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/157.15804ce1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/158.5b67f756.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/159.3ec6ab67.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/16.b6505673.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/160.dd5e5598.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/161.4b312147.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/162.a97707eb.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/163.d6d1eb4e.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/164.f6bf4c57.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/165.b79bf752.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/17.a5211f2a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/18.9a68b3e8.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/19.a90c0925.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/24.abee3e39.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/27.45e781ed.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/29.73c3e446.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/30.23fbc907.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/31.f9f495bd.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/32.9ca90e56.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/33.d365c14b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/34.49313e10.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/35.59a0d0f3.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/36.56ee0d3f.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/37.cb88291a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/38.4883bb92.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/39.27d475cc.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/40.52e63165.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/41.891c45a5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/42.a941f21e.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/43.0b9d54e1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/44.ff793978.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/45.fdce4744.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/46.73add5cb.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/47.fa9bf149.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/48.3f9faccd.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/49.44e56471.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/50.aa6210bd.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/51.02db0818.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/52.607ab005.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/53.4f8f92b8.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/54.e9eb8191.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/55.6bc2c743.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/56.b9e18c5a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/57.7298c71c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/58.4c9d3728.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/59.d8b4c833.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/60.bad43738.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/61.23fb38e7.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/62.efd16535.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/63.8a35ffd1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/64.46af0504.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/65.87ce2f36.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/66.d26fcbf1.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/67.eea3bc5e.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/68.c2cd8503.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/69.e606f0dc.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/7.6be315d6.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/70.e097ef0c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/71.44db5312.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/72.2b775323.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/73.8d897d78.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/74.8c88136f.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/75.cf20fa61.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/76.44ae83f3.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/77.0a2aa693.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/78.8d42741a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/79.d1ff5c1d.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/80.1ff928a5.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/81.0ce7f08a.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/82.789b1f40.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/83.b278993b.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/84.d9234bbf.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/86.7570f99c.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/87.48003e20.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/88.0c26d6d7.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/89.8cae8739.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/90.31cbd197.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/91.cd5165dd.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/92.54581181.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/93.e8571804.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/94.7775dac3.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/95.cd628b23.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/96.b7551936.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/97.cd40c4e6.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/98.502f7b35.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/99.9394cafc.js"><link rel="prefetch" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/vendors~flowchart.385048af.js">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/styles.90ce81ab.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/22.styles.f903ac36.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/4.styles.41ad7137.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/21.styles.1f1e2633.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/20.styles.44838259.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/25.styles.cc209185.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/0.styles.77bb68a4.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/3.styles.16f66127.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/26.styles.8994549d.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/6.styles.bb81f560.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/13.styles.eba3b1f4.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/1.styles.8ab90744.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/11.styles.bd75290f.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/23.styles.43371fdf.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/2.styles.51093229.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/nuochong/e/assets/css/28.styles.20b8b74b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div itemscope="itemscope" itemtype="https://schema.org/WebPage" class="layout-main"><meta itemprop="name" content=""> <meta itemprop="alternateName" content=""> <meta itemprop="url" content="https://luzhaoyang.com"> <nav aria-label="Navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement" class="container nav-mobile not-black" style="display:none;"><span itemprop="headline" class="nav-mobile__title not-black">导航</span> <ul class="nav-mobile__list not-black"><li class="nav-mobile__item not-black"><a href="/zh/categories/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">文章分类</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/gallery/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">摄影相册</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/comments/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">我的留言</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/travel/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">旅行简记</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/about/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">关于我们</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/contact/" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">联系我们</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/categories/backend.html" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">后端开发</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/categories/frontend.html" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">前端开发</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/categories/other.html" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">其他记录</span></a></li><li class="nav-mobile__item not-black"><a href="/zh/categories/travel.html" itemprop="url" class="nav-mobile__link not-black"><span class="bullet no_bw bullet--primary bullet--normal"></span> <span class="text not-black">旅行生活</span></a></li></ul></nav> <div class="container-fluid wrapper-body__nm"><header itemscope="itemscope" itemtype="https://schema.org/Organization" class="header"><!----> <div class="row header-top"><div class="column xs-33 sm-20"><div class="hamburguer header-top__hamburguer"><div class="hamburguer__wrapper"><span class="hamburguer__line"></span> <span class="hamburguer__line"></span> <span class="hamburguer__line"></span></div></div> <div class="languages header-top__languages"><div class="languages__box"><span class="languages__title meta-text">ZH</span> <span class="languages__icon"></span></div> <ul class="languages__list"><li class="languages__item"><a href="/" class="languages__link router-link-active">
        English
      </a></li><li class="languages__item"><a href="/zh/posts/hybrid-ying-yong-zhong-h5-yu-native-tong-xin.html" aria-current="page" class="languages__link router-link-exact-active router-link-active">
        Chinese
      </a></li></ul></div></div> <div class="column xs-33 sm-60"><div class="header__logo"><a href="/zh/" itemprop="url" class="header-top-logo__link router-link-active"><img itemprop="logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAyCAMAAAD7sXLbAAABDlBMVEUAAAA0SV00SFw0SF40SV40SF40SF0wQGA1SF2u6eau1dQ0SF01RVq+0tbfcZSuxsqwx8qtwcYzSF6y5d4wSGDpdJis3dmwztE1SV40SF2ntMCz4980R16tzs/TbpGov8Wxu8PDa4qtwcQ0SV3GaYqnu8Go0tKxv8avZII1SF2+ztS6z9XzeZ41SV6p7ubwdprki6ep6+Sx392r5+Ku5OBafok9Vmk5SV/EwcnNscDbmbF5qq/ohqTmc5eKXHh0WHJoVG670NOT0M2Gvr5ok5vWb5LLbY7AaYq1Z4erZIRGY3NuVnBDTGKg49y219eV0s+PyceMxsXJt8JwnaPUh6Lse51iiJKhYoBNbHtcUWoRJ6B1AAAALXRSTlMAwECA7+C/EJ8N828wH/3f1KBfNSD+9PPPsEwb8O7e27iUk4+BgH5sZmBTMBV50rNAAAABnUlEQVRIx42U51rCMBSGYymljAICMsS9V1paCihDEBFUcO/7vxEreTBtZt+ffd4m3zknCZiT06JQrSggHKkyRGhKKF1Fdtg/otCPXpDoEUgQiQl9FZKoSYGuQAZRfhnHkIlWkMUXlyH3oZpj+UuQj5YS+zR6TOLTvaV8CWVF4MtDyXXcKbmPOyXz6fFJ/O9R4544UwK/eW16PHQaTfxtV+B7OsJ+fvvfRuf6DdPP02IbhfJnk974awCHJoH9MvJ+qZB+68b6491kMex8xgn/0ppzYXLIE34a+U5If4D0msmDyHMniVMM1tvqIf+R5x8E/SnSuzw9QcxLEqdYRT6OI+pOfZl8baei7iQM6j7eIv+VszjpzyyES+vrBsA+cRbalO3s0+8DPgtXpL4ZByy/z67WPQQB9IU/Qf55UM/GOe/zD2u2iVXuez6ml3d3AE2STo+jMFDwPcTNwVEoCv7Rtql50kTxqD4cZNvZKuCSRNcQF2tnToGA2Fp/xZ8mYwAxRxaiVvfs0gmQsjdfv+t6SfIgDGfbG+maU9oy5Oov1sAUptGGixIAAAAASUVORK5CYII=" srcset="/logo/ktquez-play-logo.png 1x, /logo/ktquez-play-logo@2x.png 2x" alt="小窝"></a></div> <meta itemprop="name" content=""> </div> <div class="column xs-33 sm-20"><div class="search header-top__search"><!----> <span class="icon search__icon icon-search"></span></div> <div class="switch-bw header-top__toggle"><span class="switch-bw__text">
    开启夜间模式
  </span> <label for="switch-bw" class="switch-bw__label"><input type="checkbox" id="switch-bw" name="switch-bw" aria-labelledby="switch-bw-text" class="switch-bw__input"> <span class="switch-bw__ball"></span> <span id="switch-bw-text" hidden="hidden">switch to black or white</span></label></div></div></div></header> <main id="main" itemscope="itemscope" itemtype="https://schema.org/Blog" class="main-page"><div><a href="#main" class="vue-skip-to">跳到主要内容</a> <div><div class="page page__full row justify-right"><article itemscope="itemscope" itemprop="blogPost" itemtype="https://schema.org/BlogPosting" class="column xs-100 page__full__box box-default"><meta itemprop="mainEntityOfPage" content="/zh/posts/hybrid-ying-yong-zhong-h5-yu-native-tong-xin.html"> <header class="page-header page__full-header"><button type="button" class="ui-button reset-button back-button"><span class="icon back-button__icon icon--arrow icon-arrow"></span> <span class="back-button__text">返回</span></button> <div class="page-header__meta"><time datetime="Sun Jun 14 2020 12:01:00 GMT+0800 (GMT+08:00)" itemprop="datePublished" class="text">
            </time> <meta itemprop="dateModified" content="currentPost.updated_at"> <!----></div> <h1 itemprop="name headline" class="page-header__title">Hybrid 应用中 H5 与 Native 通信</h1> <div class="page-header-cat"><nav class="page-header-cat__nav"><ul class="page-header-cat__list"><li class="page-header-cat__item"><a href="/zh/categories/frontend.html" itemprop="keywords" class="page-header-cat__link meta-text">
                  前端开发
                </a></li></ul></nav></div> <div itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person" class="page-header__author"><strong>作者: </strong> <a href="/zh/authors/nuochong.html" rel="author" itemprop="url" class="link link--filler-s-primary"><span itemprop="name" class="not-black">诺冲</span></a></div></header> <!----> <!----> <section class="page-content page__full-content"><div class="row"><div class="column no-pad-l sm-50 post-share"><div class="observer" data-v-e3cf7e50><!----> <!----> <!----></div></div> <!----></div> <div class="row"><div class="column no-pad-l md-75 xl-67 post-content"><div class="post-content__box-player"><!----></div> <div class="post-content__excerpt"><!----></div> <div class="post-content__table-contents"><div class="table-contents"><h3 id="table-of-content" class="table-contents__title">目录</h3> <nav><ol class="table-contents__list"><li class="table-contents__item"><a href="#app-开发技术对比" title="APP 开发技术对比" class="table-contents__link"><span>APP 开发技术对比</span></a></li><li class="table-contents__item"><a href="#hybrid-app-应用简介" title="Hybrid App 应用简介" class="table-contents__link"><span>Hybrid App 应用简介</span></a></li><!----><!----><li class="table-contents__item"><a href="#na-调用-h5-详细流程" title="NA 调用 H5 详细流程" class="table-contents__link"><span>NA 调用 H5 详细流程</span></a></li><li class="table-contents__item"><a href="#后续" title="后续" class="table-contents__link"><span>后续</span></a></li></ol></nav></div></div> <div itemprop="articleBody"><div class="content__default"><h2 id="app-开发技术对比"><a href="#app-开发技术对比" class="header-anchor">#</a> APP 开发技术对比</h2> <ul><li><p>Native App</p> <ul><li>一般是指本地化应用，后续简称 NA；</li> <li>优点：体验好，可以做一些比较好的交互效果，可作为独立软件出售；</li> <li>缺点：更新较差，需要靠发版本解决；且历史版本无法同步更新，开发成本比较大，需要两波开发人员：Android 和 IOS，分别使用 Object-c 和 Java；</li></ul></li></ul> <ul><li><p>Web App</p> <ul><li>一般是指我们开发的 Html5 网站，后续简称 H5；</li> <li>优点：开发成本较低，前端开发人员开发一套同时适配 IOS 和 Android；更新好，可随时上线，上线后版本能普及到所有使用的用户；</li> <li>缺点：体验没有 NA 好，没有独立的软件作为入口（当然后续如果 PWA 能普及并支持下载，这也不再是缺点了）；</li></ul></li></ul> <ul><li><p>Hybird App</p> <ul><li>一般是指混合型 App，一部分是 NA 开发人员开发，一部分是 H5 页面；</li> <li>优点：跨平台开发周期短、成本低，又能发挥 Native App 体验和性能的优势</li> <li>缺点：涉及到 H5 与 NA 通信，需要客户端开发和前端开发协同合作；</li></ul></li></ul> <ul><li><p>其他 App</p> <ul><li>js + 原生渲染，框架代表：RN、Weex；自绘 UI + 原生，框架代表：Flutter，对此的介绍可参考移动开发技术简介</li></ul></li></ul> <h2 id="hybrid-app-应用简介"><a href="#hybrid-app-应用简介" class="header-anchor">#</a> Hybrid App 应用简介</h2> <p>Hybrid App 是半原生半 web 的开发模式，部分界面或者功能是原生的，其余部分是 html 和 js 来完成，最终 webview 加载 H5 页面；入职百度后第一个做的成型的产品是 Hybrid App，在开发过程中研究了 H5 与 NA 通信机制，特对通信机制进行介绍。</p> <p><strong>举例</strong>
在安卓中可以通过开启”设置“-&gt;”开发者选项“-&gt;”显示布局边界“，所有 NA 部分都会被框选出来，例如百度 App 中的首页，所有部分都有框选，整个页面都为 NA 实现；如下图所示；</p> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/0e26.webp" alt="章节配图"><figcaption>章节配图</figcaption></figure> <p>再比如百度 App 中的搜索结果页，上面搜索框的部分和下面的 Bar 都是 NA 的，而中间嵌入的刘德华页面为 H5 页面，如下图所示；再比如飞猪的机票预定页等</p> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/983f.jpg" alt="章节配图"><figcaption>章节配图</figcaption></figure> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/4afb.jpg" alt="章节配图"><figcaption>章节配图</figcaption></figure> <p>这种页面比比皆是，采用 H5 和 NA 结合 即 Hybrid App 的形式呈现。</p> <h3 id="通信"><a href="#通信" class="header-anchor">#</a> 通信</h3> <p>以我接触到的通信方式分别进行解析；</p> <h4 id="_1、na-和-h5-分别将方法挂载在-window-上，供对方使用"><a href="#_1、na-和-h5-分别将方法挂载在-window-上，供对方使用" class="header-anchor">#</a> 1、NA 和 H5 分别将方法挂载在 window 上，供对方使用</h4> <h5 id="h5-调用-na"><a href="#h5-调用-na" class="header-anchor">#</a> H5 调用 NA</h5> <p>NA 页面将方法注入到 window 上，H5 直接调用</p> <div class="language-js extra-class"><pre class="language-js"><code>webview<span class="token punctuation">.</span>addjs <span class="token operator">+</span> 原生渲染，框架代表：<span class="token constant">RN</span><span class="token function">、WeexInterface</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token string">'BdTing'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在 Object 中定义 play 方法；</p> <p>H5 调用</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>BdTing<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 播放</span>
</code></pre></div><h5 id="na-调用-h5"><a href="#na-调用-h5" class="header-anchor">#</a> NA 调用 H5</h5> <p>H5 将方法挂载在 window 上</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>BdTing<span class="token punctuation">.</span><span class="token function-variable function">share</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>NA 调用 H5 的方法</p> <div class="language-js extra-class"><pre class="language-js"><code>webview<span class="token punctuation">.</span><span class="token function">loadUrl</span><span class="token punctuation">(</span><span class="token string">'js + 原生渲染，框架代表：RN、Weex:share()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>注：addjs + 原生渲染，框架代表：RN、WeexInterface 在安卓 4.2 以下存在安全漏洞；</p></blockquote> <h4 id="_2、na-和-h5-通过-jsbridge-桥梁进行通信"><a href="#_2、na-和-h5-通过-jsbridge-桥梁进行通信" class="header-anchor">#</a> 2、NA 和 H5 通过 JsBridge 桥梁进行通信</h4> <p>原理：基于 iframe 修改 src 值，NA 可以捕获 url 变化，根据 url 变化，判断 H5 的意图，大体通信过程如下图所示；</p> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/8d23.jpg" alt="章节配图"><figcaption>章节配图</figcaption></figure> <p>在启动 App 时，App 会在 webview 中执行一个 js 文件，这个文件在 NA 与 H5 中间建立了一个桥梁，NA 与 H5 基于这个桥梁通信，这个 js 文件的作用如下图所示；具体的 js 文件见 JsBridge</p> <ul><li>创建一个隐藏的 iframe，iframe 的作用是在 H5 与 NA 通信时，会修改 iframe 的 src 值，src 的变化会触发 shouldOverriderUrlLoading 方法，这个方法的第二个参数为 src 值，方法内解析 src 值判断 H5 的意图；</li></ul> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/002d.webp" alt="章节配图"><figcaption>章节配图</figcaption></figure> <ul><li><p>在 webview 中的 window 上挂载 JsBridge 对象，这个对象中包含了一些方法：</p></li> <li><p>H5 调用 NA 的方法，参数：事件名称、参数、回调函数</p></li> <li><p>callHandler 方法会修改 iframe 的 src 值，NA 捕获到 src 变化，解析 src，判断 H5 意图；</p></li> <li><p>根据数据和事件，NA 做相应的处理，处理完成后，调用回调函数，同时把想回传给 H5 的数据作为回调函数的参数传递；</p></li> <li><p>注册方法，在 NA 状态变化时执行，参数：方法名，回调函数</p></li> <li><p>registerHandler 会将方法名对应的回调函数挂载在<code>messageHandlers</code>，即<code>messageHandlers[methodname] = callback</code>;</p></li> <li><p>NA 状态发生变化，想通知 H5，则调用相应的挂载在 messageHandlers 上的方法；</p></li> <li><p><code>registerHandler</code>方法</p></li> <li><p><code>callHandler</code>方法</p></li></ul> <blockquote><p>注：如果这两个方法比较抽象，可以看一下下面的流程详解，再回过来看当前的说明；</p></blockquote> <h3 id="h5-调用-na-详细流程"><a href="#h5-调用-na-详细流程" class="header-anchor">#</a> H5 调用 NA 详细流程</h3> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/e3ac.webp" alt="章节配图"><figcaption>章节配图</figcaption></figure> <p>我们以音频播放举例：由于希望用户离开 H5 页面时仍然可以播放音频的要求，我们采用 Hybrid App 的方案，其中音频列表是 H5 实现，播放器是 NA 实现。当用户点击音频列表中的一项时，触发的 H5 和 NA 交互流程如下：</p> <ol><li>H5 通知 NA 需要播放的音频相关参数以及回调函数，即调用 JsBridge 对象的 callHandler 方法；</li></ol> <figure><img src="data:image/webp;base64,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" alt="章节配图"><figcaption>章节配图</figcaption></figure> <ol start="2"><li>callHandler 内会修改 iframe 的 src 值为：<code>yy:__QUEUE_HAS_MESSAGE</code>，同时将 H5 的回调函数和相关参数 push 到消息队列；</li></ol> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/0464.jpg" alt="章节配图"><figcaption>章节配图</figcaption></figure> <ol start="3"><li>src 值的变化被 NA 捕获，NA 捕获后解析 src 值，根据 src 的 <code>yy:__QUEUE_HAS_MESSAGE</code> 判断 H5 有消息通知到自己，NA 会调用 JsBridge 的<code>_fetchQueue</code> 方法</li></ol> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/edac.jpg" alt="章节配图"><figcaption>章节配图</figcaption></figure> <ol start="4"><li><p><code>_fetchQueue</code> 方法会再次修改 iframe 的 src 值，将参数和调用的方法名统一添加到 src 上；NA 捕获到 src 变化后，会解析出音频参数和方法名：play，同时打开 NA 的播放器页面并播放相应的音频，并调用 JsBridge 的 <code>_handleMessageFromNative</code></p></li> <li><p><code>_handleMessageFromNative</code> 方法内将调用初始消息队列保存的回调函数，并将 NA 要通知 H5 的消息作为回调函数的参数调用。</p></li></ol> <blockquote><p>注：这个流程图中的一个疑问点是为什么需要通信两次，第一次 修改 iframe 的 src 值，通知 NA 有消息，NA 再去调用 JsBridge 里面的方法，JsBridge 的方法再修改 iframe 的 src 值，src 值变动再次被 NA 捕获，NA 再解析相应的数据，关于这个问题可以查看 github 上的 issue；</p></blockquote> <h2 id="na-调用-h5-详细流程"><a href="#na-调用-h5-详细流程" class="header-anchor">#</a> NA 调用 H5 详细流程</h2> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/7fc5.png" alt="章节配图"><figcaption>章节配图</figcaption></figure> <p>我们以音频下载举例：下载功能是 NA 实现，下载完成后 H5 页面内会显示相应的下载状态：已下载、未下载；触发的 H5 和 NA 交互流程如下：</p> <ol><li>H5 需要在 App 启动时注册：监听下载状态，调用 JsBridge 的 registerHandler 方法，参数为通信名（<code>listenDownload</code>）和对应要执行的方法（即 H5 监听到 NA 传来的消息时，会触发的方法）</li></ol> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/42d6.webp" alt="章节配图"><figcaption>章节配图</figcaption></figure> <ol start="2"><li>registerHandler 执行会存储 <code>listenDownload</code> 对应的方法；</li></ol> <figure><img src="data:image/webp;base64,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" alt="章节配图"><figcaption>章节配图</figcaption></figure> <ol start="3"><li>当 NA 页面用户点击了下载时，NA 会调用 <code>_handleMessageFromNative</code> 方法，并将下载的音频相关信息和最初与 H5 约定的点击下载时的名字<code>listenDownload</code>作为参数传递给<code>_handleMessageFromNative</code></li></ol> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/d712.webp" alt="章节配图"><figcaption>章节配图</figcaption></figure> <ol start="4"><li><code>_handleMessageFromNative</code>会根据映射获取<code>listenDownload</code>对应的方法名，并执行；H5 方法内会根据判断下载完成或者下载失败，并做相应的状态显示；</li></ol> <figure><img src="https://cdn.jsdelivr.net/gh/nuochong/e/bdc8.jpg" alt="章节配图"><figcaption>章节配图</figcaption></figure> <h2 id="后续"><a href="#后续" class="header-anchor">#</a> 后续</h2> <p>在安卓的个别机型上使用 JsBridge 通信时，H5 连续两次跟 NA 通信，会存在消息被吞的情况，即 NA 的 <code>shouldOverrideUrlLoading</code>未被触发，我们当时采用延时的办法解决；该 issue 中也有提到此问题；</p> <p>在混合式开发中，JsBridge 的安全性和兼容性比较好，很多开发仍然采用这种模式，理解其中的工作原理，可以帮助更快的定位问题；</p> <p><a href="https://mp.weixin.qq.com/s/Uj1_mJ_1jrTKA3aT12hGiw" target="_blank" rel="noopener noreferrer">Hybrid 应用中 H5 与 Native 通信<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div></div></div> <div id="shangfang" class="column no-pad-r sm-25 xl-33 xsNone smNone post-sidebar"><div class="ads-container"><!----></div> <!----> <div id="zhongjian"><div class="table-contents-fixed"><h3 id="table-of-content" class="table-contents__title">浮动目录</h3> <nav><ol class="table-contents__list"></ol></nav></div></div></div> <aside id="dibujuli" class="column xs-100"><hr class="divider"> <div><div class="observer" data-v-e3cf7e50><!----> <!----> <!----></div></div> <hr class="divider"> <section class="post-content__disqus"><!----></section></aside></div></section></article></div> <section class="row section-newsletter justify-center newsletter-post-wrap"><div class="column sm-100 md-67 xl-50"><div class="newsletter not-black"><span class="meta-text meta-text--primary not-black">关注我们</span> <h2 class="newsletter__title not-black">在收件箱接收新的内容推送</h2> <form method="post" action="https://luzhaoyang.us4.list-manage.com/subscribe/post?u=1de83ba90307cf0e38650d622&amp;amp;id=04aeba270a" class="newsletter__form not-black"><label for="email_news-1600185144387" class="newsletter__label not-black"><input type="email" name="EMAIL" id="email_news-1600185144387" required="required" placeholder="在这里输入您的电子邮件" autocomplete="off" aria-label="在这里输入您的电子邮件" value="" class="ui-input-field reset-input newsletter__input"></label> <button type="submit" class="ui-button reset-button newsletter__button txt-upper ui-button--primary">
        订阅
      </button></form></div></div></section> <aside class="container main"></aside></div> <!----> <div><div class="elevator"><a class="elevator__link"><span class="icon elevator__icon icon-greaterthan"></span> <!----></a> <!----></div> <div class="mask-container"><div class="mask-wrap"><div class="circle-wrapper"><svg xmlns="http://www.w3.org/200/svg" height="100%" width="100%"><circle cx="66" cy="66" r="55" fill="none" stroke="#FF4437" stroke-width="5" stroke-linecap="round" class="circle-full"></circle> <circle cx="66" cy="66" r="55" fill="none" stroke-width="5" stroke-linecap="round" stroke="#FF4437" stroke-dasharray="0,10000" class="circle-detail"></circle></svg> <img class="mobile-bgm-img coupon-num had-percent"></div> <div></div> <div></div> <div class="mobile-bgm-list"><i class="reco-bgm reco-bgm-last last mobile-bgm-btn"></i> <i class="reco-bgm reco-bgm-pause pause mobile-bgm-btn" style="display:none;"></i> <i class="reco-bgm reco-bgm-play play mobile-bgm-btn" style="display:;"></i> <i class="reco-bgm reco-bgm-next next mobile-bgm-btn"></i></div> <div class="mobile-bgm-close"><i class="iconfont iconLogonClosed mobile-bgm-btn"></i></div></div></div></div> <!----></div></main> <footer id="footer" class="footer "><div class="footer-box1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1366 161" class="footer-box__shape"><path d="M-11.925-4809v-154.746c40.454,19.75,273.683,130.936,420.544,142.612,161.25,12.821,339.978-42.709,521.543-86.3,169.82-40.769,395.43,29.2,423.912,38.429v60Z" transform="translate(11.926 4970)"></path></svg></div> <div class="footer-box2"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1366 246" class="footer-box__shape"><path d="M-1505.5-4725.5v-238.1c8.149-3.133,18.138-5.059,29.672-5.9h30.954c201.21,11.667,696.6,224.535,855.572,236.458,205.129,15.385,287.179-164.1,432.047-175.625a42.381,42.381,0,0,1,16.756,1.857V-4725.5Z" transform="translate(1506 4971)"></path></svg> <ul class="footer-social__list"></ul> <div class="footer-newsletter not-black"><div class="newsletter not-black"><span class="meta-text meta-text--primary not-black">关注我们</span> <h2 class="newsletter__title not-black">在收件箱接收新的内容推送</h2> <form method="post" action="https://luzhaoyang.us4.list-manage.com/subscribe/post?u=1de83ba90307cf0e38650d622&amp;amp;id=04aeba270a" class="newsletter__form not-black"><label for="email_news-1600185145863" class="newsletter__label not-black"><input type="email" name="EMAIL" id="email_news-1600185145863" required="required" placeholder="在这里输入您的电子邮件" autocomplete="off" aria-label="在这里输入您的电子邮件" value="" class="ui-input-field reset-input newsletter__input"></label> <button type="submit" class="ui-button reset-button newsletter__button txt-upper ui-button--primary">
        订阅
      </button></form></div></div></div> <section class="footer-box3"><div class="row"><div class="column sm-50 footer-card"><div class="observer" data-v-e3cf7e50><div class="spinner observer__spinner" data-v-e3cf7e50><div class="double-bounce1"></div> <div class="double-bounce2"></div></div> <!----> <!----></div></div> <div class="column sm-50 footer-nav"><div class="row justify-right"><div class="column xs-50 sm-40 md-33 footer-nav__box footer-nav__box--1 not-black"><h2 class="meta-text title not-black">我的小窝</h2> <nav class="footer-nav1"><ul><li class="footer-nav1__item"><a href="/zh/categories/" class="not-black">文章分类</a> <!----></li><li class="footer-nav1__item"><a href="/zh/gallery/" class="not-black">摄影相册</a> <!----></li><!----><li class="footer-nav1__item"><a href="/zh/travel/" class="not-black">旅行简记</a> <!----></li><li class="footer-nav1__item"><a href="/zh/about/" class="not-black">关于我们</a> <!----></li><li class="footer-nav1__item"><a href="/zh/contact/" class="not-black">联系我们</a> <!----></li></ul></nav></div> <div class="column xs-50 sm-40 md-33 footer-nav__box footer-nav__box--2"><h2 class="meta-text title not-black">社区</h2> <nav class="footer-nav2"><ul><li class="footer-nav2__item"><!----> <a href="https://jq.qq.com/?_wv=1027&amp;k=5sOoWzp" rel="noopener nofollow" target="_blank" class="not-black">Q群 931024509</a></li><li class="footer-nav2__item"><!----> <a href="https://nativescript-vue-examples.luzhaoyang.com/" rel="noopener nofollow" target="_blank" class="not-black">NSVue 示例</a></li><li class="footer-nav2__item"><!----> <a href="https://marketplace.visualstudio.com/items?itemName=nuochong.nativescript-vue-extend" rel="noopener nofollow" target="_blank" class="not-black">NSVue 扩展</a></li><li class="footer-nav2__item"><!----> <a href="https://luzhaoyang.com/vue-auto-complete/" rel="noopener nofollow" target="_blank" class="not-black">Vue Auto Complete</a></li></ul></nav></div></div></div> <div class="cpolumn sm-100 footer-copy"><p class="visitors-total" data-v-504ab208><span data-v-504ab208>累计访问</span> <span data-v-504ab208></span> <span data-v-504ab208>次</span></p> <p class="footer-copy-last">2018 - 2020 © NUOCHONG - 源于 
  <a href="https://github.com/" rel="noopener" target="_blank">
    GITHUB
  </a></p></div></div> <span class="shapes shapes--circle" style="left: 3%; top: -20%"></span> <span class="shapes shapes--primary shapes--color3" style="left: 30%; top: -15%"></span> <span class="shapes shapes--primary" style="left: 13%; top: -80%; transform: rotate(45deg)"></span> <span class="shapes shapes--circle shapes--color4" style="left: 40%; top: 200px"></span> <span class="shapes shapes--primary" style="left: 15%; bottom: 10%; transform: rotate(75deg)"></span> <span class="shapes shapes--circle shapes--color3" style="right: 50%; top: 30%"></span> <span class="shapes shapes--primary" style="right: 20%; top: -100%"></span> <span class="shapes shapes--circle" style="right: 10%; top: -20%"></span> <span class="shapes shapes--color4" style="right: 35%; top: -20%; transform: rotate(45deg)"></span> <span class="shapes shapes--circle" style="left: 40%; top: -50%"></span> <span class="shapes shapes--color3" style="right: 30%; top: 20%"></span> <span class="shapes shapes--circle shapes--primary" style="right: 30%; bottom: 20%"></span></section></footer></div> <!----> <!----></div><div class="global-ui"><div><!----> <!----></div><!----></div></div>
    <script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/app.90ce81ab.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/22.f903ac36.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/4.41ad7137.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/21.1f1e2633.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/20.44838259.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/25.cc209185.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/0.77bb68a4.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/5.e3e753ea.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/3.16f66127.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/26.8994549d.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/85.e90e94c2.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/6.bb81f560.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/13.eba3b1f4.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/1.8ab90744.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/11.bd75290f.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/23.43371fdf.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/2.51093229.js" defer></script><script src="https://cdn.jsdelivr.net/gh/nuochong/e/assets/js/28.20b8b74b.js" defer></script>
  </body>
</html>
