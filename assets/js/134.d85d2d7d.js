(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{2109:function(t,a,s){"use strict";s.r(a);var e=s(3),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("几种常见的攻击方式：")]),t._v(" "),s("ol",[s("li",[t._v("SQL 注入")]),t._v(" "),s("li",[t._v("XSS")]),t._v(" "),s("li",[t._v("CSRF")]),t._v(" "),s("li",[t._v("点击劫持")]),t._v(" "),s("li",[t._v("中间人攻击")])]),t._v(" "),s("h2",{attrs:{id:"_1-sql-注入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-sql-注入"}},[t._v("#")]),t._v(" 1. SQL 注入")]),t._v(" "),s("p",[t._v("这是一种比较简单的攻击方式。")]),t._v(" "),s("p",[t._v("如果后台人员使用用户输入的数据来组装 SQL 查询语句的时候不做防范， 遇到一些恶意的输入， 最后生成的 SQL 就会有问题。")]),t._v(" "),s("p",[t._v("举个例子")]),t._v(" "),s("p",[t._v("比如地址栏输入的是：")]),t._v(" "),s("div",{staticClass:"language-url extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("articlrs/index.php?id=1\n")])])]),s("p",[t._v("发送一个 get 请求， 调用的查询语句是：")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sql")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SELECT * FROM articles WHERE id ="')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" $id\n")])])]),s("p",[t._v("正常情况下， 返回 id = 1 的文章。")]),t._v(" "),s("p",[t._v("如果攻击者想获得所有的文章，语句就可以改成：")]),t._v(" "),s("div",{staticClass:"language-url extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("articlrs/index.php?id=-1 OR 1 = 1\n")])])]),s("p",[t._v("这样就可以了， 为什么呢？")]),t._v(" "),s("p",[t._v("这是因为，id = -1 永远是 false，1=1 永远是 true，所有整个 where 语句永远是 ture.")]),t._v(" "),s("p",[t._v("所以 where 条件相当于没有加 where 条件，那么查询的结果相当于整张表的内容，攻击者就达到了目的。")]),t._v(" "),s("p",[t._v("现在的系统一般都会加入"),s("code",[t._v("过滤")]),t._v("和"),s("code",[t._v("验证")]),t._v("机制， 可以有效预防 SQL 注入问题。")]),t._v(" "),s("h2",{attrs:{id:"_2-什么是-xss-如何防范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-什么是-xss-如何防范"}},[t._v("#")]),t._v(" 2.什么是 XSS， 如何防范")]),t._v(" "),s("p",[t._v("XSS 全称是"),s("code",[t._v("跨站脚本攻击")]),t._v("。")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("代码注入")]),t._v("的方式来达到攻击的目的。")]),t._v(" "),s("p",[t._v("举个例子")]),t._v(" "),s("p",[t._v("我们有个社交网站，允许大家相互访问空间，网站可能是这样做的：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("form")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("action")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("method")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("POST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("submit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("submit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("input> form>\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("你输入的内容: {{{text}}}h2>"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("form")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("如果你用的是 Chrome 浏览器， 会得到来自浏览器的警告：")]),t._v(" "),s("p",[t._v("Chrome 这类浏览器能自动帮助用户防御攻击， 很贴心。")]),t._v(" "),s("p",[t._v("但是也不是说， 只要我用 Chrome 就万事大吉了，该防御， 还得防御。")]),t._v(" "),s("p",[t._v("「如何防御 XSS」")]),t._v(" "),s("p",[t._v("对于 XSS 攻击，通常来说，有两种方式可以防御：")]),t._v(" "),s("ol",[s("li",[t._v("字符转译")]),t._v(" "),s("li",[t._v("CSP(Content Security Policy)")])]),t._v(" "),s("p",[s("strong",[t._v("01 字符转译")])]),t._v(" "),s("p",[t._v("做法就是转义输入输出的内容，对于引号、尖括号、斜杠等字符进行转义。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('& 替换为：&\n< 替换为：&lt;\n> 替换为：&gt;\n” 替换为："\n‘ 替换为：&#x27;\n/ 替换为：&#x2f;\n')])])]),s("p",[t._v("通过转义可以将攻击代码")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("alert('1')script>\n")])])]),s("p",[t._v("转译成:")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token entity named-entity",title:"<"}},[t._v("&lt;")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token entity named-entity",title:">"}},[t._v("&gt;")]),t._v("alert(1)"),s("span",{pre:!0,attrs:{class:"token entity named-entity",title:"<"}},[t._v("&lt;")]),s("span",{pre:!0,attrs:{class:"token entity",title:"&#x2F;"}},[t._v("&#x2F;")]),t._v("script>\n")])])]),s("p",[t._v("替换了这些字符之后，恶意代码就会"),s("code",[t._v("失效")]),t._v("，XSS 攻击将不会轻易发生。")]),t._v(" "),s("p",[t._v("对于"),s("code",[t._v("一般的输入")]),t._v("， 可以像上面那样粗暴的转译。")]),t._v(" "),s("p",[t._v("有些情况， 光转译也是不够的，比如：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("{{xss}}"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("点我a>"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("链接中如果存在"),s("code",[t._v("javacript:")]),t._v("开头的协议，点击链接时浏览器会执行后面的代码。\n这个时候光转义是没有用的，需要对 url 协议进行"),s("code",[t._v("白名控制")]),t._v("，只允许"),s("code",[t._v("http")]),t._v(","),s("code",[t._v("https")]),t._v(","),s("code",[t._v("http")]),t._v(","),s("code",[t._v("mailto")]),t._v("等安全协议。\n包括图片"),s("code",[t._v("src")]),t._v("属性"),s("code",[t._v('img src="'+t._s(t.xss)+'"')]),t._v(","),s("code",[t._v('iframe iframe src="'+t._s(t.xss)+'"')]),t._v("都会存在这样的问题，都需要白名单处理。\n但是别的一些情况， 比如，"),s("code",[t._v("富文本")]),t._v("，这时候就不能这么干了。")]),t._v(" "),s("p",[t._v("如此粗暴的转译会破坏掉原有的格式。")]),t._v(" "),s("p",[t._v("这种情况， 比较合适的策略是使用白名单进行过滤标签和属性。")]),t._v(" "),s("p",[t._v("说完字符转译， 我们再看看 CSP。")]),t._v(" "),s("p",[s("strong",[t._v("02 CSP")])]),t._v(" "),s("p",[t._v("CSP , Content Security Policy 。")]),t._v(" "),s("p",[t._v("本质也是"),s("code",[t._v("白名单")]),t._v("，通过设置白名单， 我们可以设置"),s("code",[t._v("允许浏览器加载哪些外部资源")]),t._v("。")]),t._v(" "),s("p",[t._v("要开启 CSP 可以通过两种方式：")]),t._v(" "),s("p",[t._v("设置 HTTP Header 中的"),s("code",[t._v("Content-Security-Policy")]),t._v("\n设置"),s("code",[t._v("meta")]),t._v("标签的方式")]),t._v(" "),s("p",[t._v("只要配置了正确的规则，那么即使网站存在漏洞，恶意代码也不会被执行。")]),t._v(" "),s("p",[t._v("CSP 兼容性：")]),t._v(" "),s("p",[t._v("CSP 文档地址：")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("strong",[t._v("3 CSRF")])]),t._v(" "),s("p",[t._v("CSRF 全称是"),s("code",[t._v("跨站请求伪造")]),t._v("( Cross Site Request Forgery)\n本质上， 说白了就是"),s("code",[t._v("借用")]),t._v("用户的"),s("code",[t._v("身份或权限")]),t._v("偷偷的完成某些操作。\nCSRF 的发生其实是借助了"),s("code",[t._v("cookie")]),t._v("的特性。")]),t._v(" "),s("p",[t._v("举个例子")]),t._v(" "),s("p",[t._v("我们登录了某个 "),s("a",{attrs:{href:"http://tao.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://tao.com"),s("OutboundLink")],1),t._v(" 购物网站之后，cookie 就会有登录过的标记了。")]),t._v(" "),s("p",[t._v("此时请求http://tao.com/pay?id=123&money=1000， 是会带着 cookie 的，server 端就知道已经登录了。")]),t._v(" "),s("p",[t._v("如果在http://tao.com去请求其他域名的 API , 例如http://tx.com/api时，是不会带 cookie 的，这是浏览器同源策略的限制。")]),t._v(" "),s("p",[t._v("但是此时在其他域名的页面中，请求http://tao.com/pay?id=123&money=1000，就会带着tao.com的 cookie 。")]),t._v(" "),s("p",[t._v("这是发生 CSRF 攻击的理论基础。")]),t._v(" "),s("p",[t._v("「如何防御 CSRF」")]),t._v(" "),s("p",[t._v("防御 CSRF 有效的手段就是加入各个层级的权限验证.")]),t._v(" "),s("p",[t._v("例如现在的购物网站，只要涉及现金交易，肯定要输入密码或者扫码验证才行。")]),t._v(" "),s("p",[t._v("除此之外，敏感的接口要使用 POST 请求而不是 GET.")]),t._v(" "),s("p",[s("strong",[t._v("4 点击劫持")])]),t._v(" "),s("p",[t._v("click-jacking，也被称为 UI-覆盖攻击。")]),t._v(" "),s("p",[t._v("这也是比较常问到的一个问题，也是我们最常见的一种情况。")]),t._v(" "),s("p",[t._v("攻击方式就是在某些操作的按钮上加一层"),s("code",[t._v("透明的iframe")]),t._v("。")]),t._v(" "),s("p",[t._v("点击一下， 就入坑了。")]),t._v(" "),s("p",[t._v("「如何防御点击劫持」")]),t._v(" "),s("p",[t._v("常用的两种方式：")]),t._v(" "),s("ol",[s("li",[t._v("使用"),s("code",[t._v("HTTP 头")]),t._v("防御")])]),t._v(" "),s("p",[t._v("通过配置 nginx 发送"),s("code",[t._v("X-Frame-Option")]),t._v("s 响应头，这个 HTTP 响应头 就是为了防御用 iframe 嵌套的点击劫持攻击。 这样浏览器就会阻止嵌入网页的渲染。")]),t._v(" "),s("p",[t._v("该响应头有三个值可选，分别是：")]),t._v(" "),s("p",[s("code",[t._v("DENY")]),t._v("，表示页面不允许通过 iframe 的方式展示。\n"),s("code",[t._v("SAMEORIGIN")]),t._v("，表示页面可以在相同域名下通过 iframe 的方式展示。\n"),s("code",[t._v("ALLOW-FROM")]),t._v("，表示页面可以在指定来源的 iframe 中展示。")]),t._v(" "),s("p",[t._v("更详细的可以查阅 MDN 上关于 X-Frame-Options 响应头的内容。")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("使用"),s("code",[t._v("Javascript")]),t._v("防御")])]),t._v(" "),s("p",[t._v("判断顶层视口的域名是不是和本页面的"),s("code",[t._v("域名一致")]),t._v("，如果不一致就让恶意网页自动跳转到我方的网页。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("top"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hostname "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hostname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'您正在访问不安全的页面，即将跳转到安全页面！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  top"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("href "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("href"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("5 中间人攻击")])]),t._v(" "),s("p",[t._v("中间人攻击（Man-in-the-Middle Attack, MITM）是一种由来已久的网络入侵手段，如 SMB 会话劫持、DNS 欺骗等攻击都是典型的 MITM 攻击。")]),t._v(" "),s("p",[t._v("简而言之，所谓的 MITM 攻击就是通过拦截正常的网络通信数据，并进行数据篡改和嗅探来达到攻击的目的，而通信的双方却毫不知情。")]),t._v(" "),s("p",[t._v("「如何防御中间人攻击」")]),t._v(" "),s("p",[t._v("以下是针对防止中间人攻击的一些建议：")]),t._v(" "),s("ol",[s("li",[t._v("确保当前你所访问的网站使用了"),s("code",[t._v("HTTPS")])]),t._v(" "),s("li",[t._v("如果你是一个网站管理员，你应当执行"),s("code",[t._v("HSTS协议")])]),t._v(" "),s("li",[s("code",[t._v("不要在公共Wi-Fi上")]),t._v("发送敏感数据")]),t._v(" "),s("li",[t._v("如果你的网站使用了"),s("code",[t._v("SSL")]),t._v("，确保你禁用了不安全的 SSL/TLS 协议。")]),t._v(" "),s("li",[t._v("不要点击恶意链接或电子邮件。")])]),t._v(" "),s("p",[t._v("还有一个容易被忽略的漏洞")]),t._v(" "),s("p",[t._v("window.opener\n带有"),s("code",[t._v('target="_blank"')]),t._v("跳转的网页拥有了浏览器"),s("code",[t._v("window.opener")]),t._v("对象赋予的对原网页的跳转权限，这可能会被恶意网站利用，例如一个恶意网站在某 UGC 网站 Po 了其恶意网址，该 UGC 网站用户在新窗口打开页面时，恶意网站利用该漏洞将原 UGC 网站跳转到伪造的钓鱼页面，用户返回到原窗口时可能会忽视浏览器 URL 已发生了变化，伪造页面即可进一步进行钓鱼或其他恶意行为:\n代码如下")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script language"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"javascript"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nwindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("opener"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://example.com'")]),t._v("\nscript"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("想象一下，你在浏览淘宝的时候，点击了网页聊天窗口的一条外链，出去看了一眼，回来之后淘宝网已经变成了另一个域名的高仿网站，而你却未曾发觉，继续买东西把自己的钱直接打到骗子手里。\n如何修复\n为"),s("code",[t._v('target="_blank"')]),t._v("加上"),s("code",[t._v('rel="noopener noreferrer"')]),t._v("属性。")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("外跳的地址"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("noopener noreferrer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("外跳的地址a>"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("缺点: 为禁止了跳转带上 referrer，目标网址"),s("code",[t._v("没办法检测来源地址")]),t._v("。\n还有一种方法是，"),s("code",[t._v("所有的外部链接都替换为内部的跳转连接服务")]),t._v("，点击连接时，先跳到内部地址，再由服务器 redirect 到外部网址。\n现在很多站点都是这么做的, 不仅可以规避风险，还可以控制非法站点的打开：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('"/redirect?target=http%3A%2F%2Fxxx.yyy.com">\n  http://xxx.yyy.com\n</a>\n')])])]),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/mI859obHtYoj9OH9jS780g",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web 常见攻击总结"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);